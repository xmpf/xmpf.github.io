<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.82.0" />

  <title>HackadayU - Introduction to Reverse Engineering with Ghidra &middot; ☣ ishtar ☣</title>

  <meta name="description" content="" />

  

<meta itemprop="name" content="HackadayU - Introduction to Reverse Engineering with Ghidra">
<meta itemprop="description" content="Workshop Setup  Create a virtual machine Download Ghidra: https://ghidra-sre.org/ Download workshop files  git clone https://github.">

<meta itemprop="wordCount" content="5024">
<meta itemprop="keywords" content="ghidra,sre,reversing,hackadayu," />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HackadayU - Introduction to Reverse Engineering with Ghidra"/>
<meta name="twitter:description" content="Workshop Setup  Create a virtual machine Download Ghidra: https://ghidra-sre.org/ Download workshop files  git clone https://github."/>


<meta property="og:title" content="HackadayU - Introduction to Reverse Engineering with Ghidra" />
<meta property="og:description" content="Workshop Setup  Create a virtual machine Download Ghidra: https://ghidra-sre.org/ Download workshop files  git clone https://github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mxpapad.me/posts/ghidra_intro/ghidra_intro/" /><meta property="article:section" content="posts" />






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type":"Person",
      "@id": "https://mxpapad.me/#author",
      "name": "ishtar",
      "image": {
        "@type":"ImageObject",
        
        
      },
      "description": "988C 6C07 3240 2D14"
    },
    {
      "@type": "WebSite",
      "@id": "https://mxpapad.me/#website",
      "url": "https://mxpapad.me/",
      "name": "☣ ishtar ☣",
      "description": "988C 6C07 3240 2D14",
      "publisher": {
        "@id": "https://mxpapad.me/#author"
      },
      "inLanguage": "en-us"
    },
    {
      "@type": "WebPage",
      "@id": "https://mxpapad.me/posts/ghidra_intro/ghidra_intro/#webpage",
      "url": "https://mxpapad.me/posts/ghidra_intro/ghidra_intro/",
      "name": "HackadayU - Introduction to Reverse Engineering with Ghidra",
      "isPartOf": {
        "@id": "https://mxpapad.me/#website"
      },
      "about": {
         "@id": "https://mxpapad.me/#author"
      },
      "description": "Workshop Setup  Create a virtual machine Download Ghidra: https://ghidra-sre.org/ Download workshop files  git clone https://github.",
      "inLanguage": "en-us",
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": [
            "https://mxpapad.me/posts/ghidra_intro/ghidra_intro/"
          ]
        }
      ]
    },
    {
      "@type": "Article",
      "isPartOf": {
        "@id": "https://mxpapad.me/posts/ghidra_intro/ghidra_intro/#webpage"
      },
      "mainEntityOfPage": {
        "@id": "https://mxpapad.me/posts/ghidra_intro/ghidra_intro/#webpage"
      },
      "headline": "HackadayU - Introduction to Reverse Engineering with Ghidra",
      "publisher": {
        "@id": "https://mxpapad.me/#author"
      },
      "keywords": [
        "ghidra",
        "sre",
        "reversing",
        "hackadayu"
      ],
      "articleSection": [
      ],
      "inLanguage": "en-us",
      "author": {
        "@type": "Person",
        "name": "ishtar"
      },
      "potentialAction": [
        {
          "@type": "CommentAction",
          "name": "Comment",
          "target": [
            "https://mxpapad.me/posts/ghidra_intro/ghidra_intro/#comments"
          ]
        }
      ]
    }
  ]
}
</script>



  <link type="text/css"
        rel="stylesheet"
        href="/css/print.css"
        media="print">

  <link type="text/css"
        rel="stylesheet"
        href="/css/poole.css">

  <link type="text/css"
        rel="stylesheet"
        href="/css/hyde.css">

  
<style type="text/css">
  .sidebar {
    background-color: #333333;
  }

  .read-more-link a {
    border-color: #333333;
  }

  .read-more-link a:hover {
    background-color: #333333;
  }

  .pagination li a {
    color: #333333;
    border: 1px solid #333333;
  }

  .pagination li.active a {
    background-color: #333333;
  }

  .pagination li a:hover {
    background-color: #333333;
    opacity: 0.75;
  }

  footer a,
  .content a,
  .related-posts li a:hover {
    color: #333333;
  }
</style>



  

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
        integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
        crossorigin="anonymous" />

  <link rel="apple-touch-icon-precomposed"
        sizes="144x144"
        href="/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/favicon.png">

  
  </head>
<body>
  <aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
      

      <h1>☣ ishtar ☣</h1>

      
      <p class="lead">988C 6C07 3240 2D14</p>
      
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li>
          <a href="https://mxpapad.me/">~</a>
        </li>
        <li>
          <a href="/posts/">~/posts</a>
        </li><li>
          <a href="/about/">~/about</a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://www.linkedin.com/in/michalis-papadopoullos/" rel="me" title="Linkedin" target="_blank">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      
      <a href="https://github.com/xmpf" rel="me" title="GitHub" target="_blank">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="https://twitter.com/megatr0nz" rel="me" title="Twitter" target="_blank">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      
    </section>
  </div>
</aside>


  <main class="content container">
  <div class="post">
  <h1 class="title">HackadayU - Introduction to Reverse Engineering with Ghidra</h1>
  

  <div class="post-date">
  </div>

  <div>
  <h1 id="workshop-setup">Workshop Setup</h1>
<ul>
<li>Create a virtual machine</li>
<li>Download Ghidra: <a href="https://ghidra-sre.org/">https://ghidra-sre.org/</a></li>
<li>Download workshop files
<ul>
<li><code>git clone https://github.com/wrongbaud/hackaday-u</code></li>
</ul>
</li>
<li>Playlist: <a href="https://www.youtube.com/playlist?list=PL_tws4AXg7auglkFo6ZRoWGXnWL0FHAEi">https://www.youtube.com/playlist?list=PL_tws4AXg7auglkFo6ZRoWGXnWL0FHAEi</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p>Software reverse engineering (SRE) is the practice of analyzing a software system, either in whole or in part, to extract design and implementation information.</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210530125250.png" alt=""></p>
<h1 id="lecture-1">Lecture 1</h1>
<p>Course Video: <a href="https://youtu.be/d4Pgi5XML8E">https://youtu.be/d4Pgi5XML8E</a></p>
<ul>
<li>0:00 - Presentation Outline</li>
<li>2:50 - What is Software Reverse Engineering?</li>
<li>4:12 - Software Engineering Review</li>
<li>24:54 - x86_64 Architecture Review</li>
<li>45:10 - Ghidra Overview and Basic Usage</li>
</ul>
<p><img src="https://jsommers.github.io/cbook/_images/compilesteps.png" alt="https://jsommers.github.io/cbook"></p>
<p><img src="https://www.computerhope.com/jargon/m/machine-cycle.png" alt="What is a Machine Cycle?"></p>
<h3 id="linking">Linking</h3>
<ul>
<li>Define memory regions
<ul>
<li>Linker scripts</li>
</ul>
</li>
</ul>
<p>Linker Scripts:</p>
<ul>
<li><a href="https://microcontrollerslab.com/bare-metal-embedded-systems-linker-script-file/">https://microcontrollerslab.com/bare-metal-embedded-systems-linker-script-file/</a></li>
<li><a href="https://interrupt.memfault.com/blog/how-to-write-linker-scripts-for-firmware">https://interrupt.memfault.com/blog/how-to-write-linker-scripts-for-firmware</a></li>
</ul>
<h2 id="exercises">Exercises</h2>
<h3 id="exercise-c1">Exercise c1</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ file c1
c1: ELF 64-bit LSB shared object, x86-64, version <span style="color:#099">1</span> <span style="color:#000;font-weight:bold">(</span>SYSV<span style="color:#000;font-weight:bold">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span style="color:#000;font-weight:bold">for</span> GNU/Linux 3.2.0, BuildID<span style="color:#000;font-weight:bold">[</span>sha1<span style="color:#000;font-weight:bold">]=</span>d9462be5061532875d1ea68aab66366a42f87d6c, not stripped
</code></pre></td></tr></table>
</div>
</div><ul>
<li>x86-64</li>
<li>The file is not stripped and therefore has all symbols included in the binary.</li>
<li>SYSV ABI</li>
</ul>
<p>Locating the entry point address defined in the ELF header:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526150125.png" alt=""></p>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> strcmp_ret;
  size_t length;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(<span style="color:#d14">&#34;hackadayu&#34;</span>);
    strcmp_ret <span style="color:#000;font-weight:bold">=</span> strncmp(argv[<span style="color:#099">1</span>],<span style="color:#d14">&#34;hackadayu&#34;</span>,length);
    <span style="color:#000;font-weight:bold">if</span> (strcmp_ret <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span>) {
      printf(<span style="color:#d14">&#34;Correct! The password was %s this whole time!</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,argv[<span style="color:#099">1</span>]);
      strcmp_ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      printf(<span style="color:#d14">&#34;Wrong answer, we</span><span style="color:#d14">\&#39;</span><span style="color:#d14">d never use %s as the password!</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,argv[<span style="color:#099">1</span>]);
      strcmp_ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please supply the password!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    strcmp_ret <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> strcmp_ret;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="exercise-c2">Exercise c2</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ file c2
c2: ELF 64-bit LSB executable, x86-64, version <span style="color:#099">1</span> <span style="color:#000;font-weight:bold">(</span>SYSV<span style="color:#000;font-weight:bold">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span style="color:#000;font-weight:bold">for</span> GNU/Linux 2.6.24, BuildID<span style="color:#000;font-weight:bold">[</span>sha1<span style="color:#000;font-weight:bold">]=</span>62d28f8ac9c89ed9b31363dd715564a454c7710d, not stripped
</code></pre></td></tr></table>
</div>
</div><p>Similarly, the second binary is also non stripped, and therefore symbols will be available.</p>
<p>Using <code>readelf</code>, we can read the ELF header:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526155508.png" alt=""></p>
<p>Using <code>checksec</code> we can identify what binary security features are enabled:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526155857.png" alt=""></p>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t length;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    <span style="color:#000;font-weight:bold">if</span> (length <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">5</span>) {
      puts(<span style="color:#d14">&#34;We</span><span style="color:#d14">\&#39;</span><span style="color:#d14">d never use a password that short!&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      <span style="color:#000;font-weight:bold">if</span> ((<span style="color:#000;font-weight:bold">*</span>argv[<span style="color:#099">1</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;h&#39;</span>) <span style="color:#000;font-weight:bold">&amp;&amp;</span> (argv[<span style="color:#099">1</span>][<span style="color:#099">4</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;u&#39;</span>)) {
        puts(<span style="color:#d14">&#34;Correct -- maybe we should pay attention to more characters...&#34;</span>);
        ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
      }
      <span style="color:#000;font-weight:bold">else</span> {
        puts(<span style="color:#d14">&#34;Wrong answer! Try again&#34;</span>);
        ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
      }
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please supply the password!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><p>The provided input must:</p>
<ul>
<li>length &gt;= 5</li>
<li>input[0] = &lsquo;h&rsquo; &amp;&amp; input[4] = &lsquo;u&rsquo;</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210526160328.png" alt=""></p>
<h3 id="exercise-c3">Exercise c3</h3>
<p>Following the same procedure, we get some information about the target binary:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526160649.png" alt=""></p>
<p>As usual, we change the function signature of the <code>main</code> function, as specified by the SYSV ABI:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526161130.png" alt=""></p>
<p>By generating the Graph for <code>main</code> function we can inspect the control flow and have a high level overview of the code:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526162546.png" alt=""></p>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t length;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    <span style="color:#000;font-weight:bold">if</span> (length <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">5</span>) {
      puts(<span style="color:#d14">&#34;Come on now ...  you should expect betTer from us!&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      <span style="color:#000;font-weight:bold">if</span> ((uint)(byte)argv[<span style="color:#099">1</span>][<span style="color:#099">2</span>] <span style="color:#000;font-weight:bold">-</span> (uint)(byte)argv[<span style="color:#099">1</span>][<span style="color:#099">3</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0x20</span>) {
        puts(<span style="color:#d14">&#34;Correct! You figured it out ... looks like we have to upgrade our security...&#34;</span>);
        ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
      }
      <span style="color:#000;font-weight:bold">else</span> {
        puts(<span style="color:#d14">&#34;IncorRect pasSword!&#34;</span>);
        ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
      }
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please provide the secret pasSword!&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><p>The input password should:</p>
<ul>
<li>length &gt;= 5</li>
<li>input[2] = input[3] + 0x20 (e.g: <code>input[2] = 'a' &amp;&amp; input[3] = 'A'</code>)</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210526163256.png" alt=""></p>
<h3 id="exercise-c4">Exercise c4</h3>
<p><img src="/ghidra_intro/Pasted%20image%2020210526165627.png" alt=""></p>
<p>Load the binary in Ghidra and change the function signature of the <code>main</code> function:</p>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t length;
  <span style="color:#458;font-weight:bold">int</span> counter;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    <span style="color:#000;font-weight:bold">if</span> (length <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">10</span>) {
      puts(<span style="color:#d14">&#34;Come on now ...  you should expect better from us!&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
      counter <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
      <span style="color:#000;font-weight:bold">while</span> (counter <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#458;font-weight:bold">int</span>)length) {
        <span style="color:#000;font-weight:bold">if</span> (<span style="color:#d14">&#34;hackaday-u&#34;</span>[counter] <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">2</span> <span style="color:#000;font-weight:bold">!=</span> (<span style="color:#458;font-weight:bold">int</span>)argv[<span style="color:#099">1</span>][counter]) {
          puts(<span style="color:#d14">&#34;Wrong Password!&#34;</span>);
          <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
        }
        counter <span style="color:#000;font-weight:bold">=</span> counter <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
      }
      puts(<span style="color:#d14">&#34;Correct! You</span><span style="color:#d14">\&#39;</span><span style="color:#d14">ve entered the right password ... you</span><span style="color:#d14">\&#39;</span><span style="color:#d14">re getting better at this!&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please provide the secret password!&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><p>Input password must:</p>
<ul>
<li>length &gt;= 10</li>
<li>each character of input password must be 2 greater in ASCII code than the corresponding character in &ldquo;hackaday-u&rdquo; string.</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210526170246.png" alt=""></p>
<h3 id="exercise-nasm_crack">Exercise nasm_crack</h3>
<p>It&rsquo;s generally a good practice to always check the binary for the following information:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526170723.png" alt=""></p>
<p>The only function defined is <code>entry</code> as shown in the Symbol Tree window in Ghidra:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526170909.png" alt=""></p>
<p>Some strings were not correctly identified, as they are not NULL terminated. So let&rsquo;s convert them manually:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526172018.png" alt=""></p>
<p>Disassembled code:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526172252.png" alt=""></p>
<p>Additionally, some syscalls were not identified by the decompiler. There is a script that we can use to automatically find and resolve those references:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526172636.png" alt=""></p>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">entry</span>(<span style="color:#458;font-weight:bold">void</span>)
{
  <span style="color:#458;font-weight:bold">long</span> counter;
  <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>ptr_input;
  <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>ptr_passwd;
  <span style="color:#458;font-weight:bold">bool</span> is_char_same;
  
  write(<span style="color:#099">1</span>,prompt_msg,<span style="color:#099">0x16</span>);
  read(<span style="color:#099">0</span>,<span style="color:#000;font-weight:bold">&amp;</span>input,<span style="color:#099">0x10</span>);
  
  counter <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xb</span>;
  ptr_input <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">&amp;</span>input;
  ptr_passwd <span style="color:#000;font-weight:bold">=</span> passwd;
  
  <span style="color:#000;font-weight:bold">do</span> {
    <span style="color:#000;font-weight:bold">if</span> (counter <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span>) <span style="color:#000;font-weight:bold">break</span>;
    counter <span style="color:#000;font-weight:bold">=</span> counter <span style="color:#000;font-weight:bold">+</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    is_char_same <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">*</span>ptr_input <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">*</span>ptr_passwd;
    ptr_input <span style="color:#000;font-weight:bold">=</span> ptr_input <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
    ptr_passwd <span style="color:#000;font-weight:bold">=</span> ptr_passwd <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
  } <span style="color:#000;font-weight:bold">while</span> (is_char_same);
  
  <span style="color:#000;font-weight:bold">if</span> (<span style="color:#000;font-weight:bold">!</span>is_char_same) {
    write(<span style="color:#099">1</span>,wrong,<span style="color:#099">7</span>);
    exit(<span style="color:#099">0</span>);
  }
  
  write(<span style="color:#099">1</span>,correct,<span style="color:#099">9</span>);
  
  exit(<span style="color:#099">0</span>);
  <span style="color:#000;font-weight:bold">return</span>;
}

</code></pre></td></tr></table>
</div>
</div><p>Password is: <code>supersecret</code></p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526172750.png" alt=""></p>
<h3 id="exercise-simplekeygen">Exercise SimpleKeyGen</h3>
<p><img src="/ghidra_intro/Pasted%20image%2020210526173231.png" alt=""></p>
<p>Graph view:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526173628.png" alt=""></p>
<p>Decompiled code:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526173756.png" alt=""></p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526174119.png" alt=""></p>
<p>KeyGen:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-python" data-lang="python"><span style="color:#998;font-style:italic">#!/usr/bin/python3</span>

<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">string</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">random</span>

<span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">main</span>():
    charset <span style="color:#000;font-weight:bold">=</span> string<span style="color:#000;font-weight:bold">.</span>ascii_letters <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;0123456789&#34;</span> <span style="color:#000;font-weight:bold">+</span> string<span style="color:#000;font-weight:bold">.</span>punctuation
    serial_key <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;&#34;</span>
    <span style="color:#000;font-weight:bold">while</span> <span style="color:#0086b3">len</span>(serial_key) <span style="color:#000;font-weight:bold">!=</span> <span style="color:#099">0x10</span>:
        rnd <span style="color:#000;font-weight:bold">=</span> random<span style="color:#000;font-weight:bold">.</span>choice(charset)
        serial_key <span style="color:#000;font-weight:bold">+=</span> rnd
        serial_key <span style="color:#000;font-weight:bold">+=</span> <span style="color:#0086b3">chr</span>(<span style="color:#0086b3">ord</span>(rnd) <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>)
    
    <span style="color:#000;font-weight:bold">print</span>(serial_key)

<span style="color:#000;font-weight:bold">if</span> __name__ <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;__main__&#39;</span>:
    main()
</code></pre></td></tr></table>
</div>
</div><p><img src="/ghidra_intro/Pasted%20image%2020210526175028.png" alt=""></p>
<h3 id="exercise-skele">Exercise skele</h3>
<p><img src="/ghidra_intro/Pasted%20image%2020210527103542.png" alt=""></p>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t input_length;
  size_t secret_length;
  <span style="color:#458;font-weight:bold">long</span> in_FS_OFFSET;
  <span style="color:#458;font-weight:bold">int</span> counter;
  byte xor_values [<span style="color:#099">8</span>];
  longlong stack_canary;
  
  stack_canary <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">*</span>(longlong <span style="color:#000;font-weight:bold">*</span>)(in_FS_OFFSET <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">0x28</span>);
  
  xor_values[<span style="color:#099">0</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">8</span>;
  xor_values[<span style="color:#099">1</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">9</span>;
  xor_values[<span style="color:#099">2</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">10</span>;
  xor_values[<span style="color:#099">3</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xb</span>;
  xor_values[<span style="color:#099">4</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xc</span>;
  xor_values[<span style="color:#099">5</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xd</span>;
  xor_values[<span style="color:#099">6</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xe</span>;
  xor_values[<span style="color:#099">7</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xf</span>;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    input_length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    secret_length <span style="color:#000;font-weight:bold">=</span> strlen(<span style="color:#d14">&#34;skeletor&#34;</span>);
    
	<span style="color:#000;font-weight:bold">if</span> (input_length <span style="color:#000;font-weight:bold">&lt;</span> secret_length) {
      puts(<span style="color:#d14">&#34;Wrong length, better luck next time!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      counter <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
      <span style="color:#000;font-weight:bold">while</span> (counter <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">8</span>) {
        <span style="color:#000;font-weight:bold">if</span> ((byte)(<span style="color:#d14">&#34;skeletor&#34;</span>[counter] <span style="color:#000;font-weight:bold">^</span> xor_values[counter]) <span style="color:#000;font-weight:bold">!=</span> argv[<span style="color:#099">1</span>][counter]) {
          printf(<span style="color:#d14">&#34;%c</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,(ulong)(uint)(<span style="color:#458;font-weight:bold">int</span>)(<span style="color:#458;font-weight:bold">char</span>)(xor_values[counter] <span style="color:#000;font-weight:bold">^</span> <span style="color:#d14">&#34;skeletor&#34;</span>[counter]));
          printf(<span style="color:#d14">&#34;%c</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,(ulong)(uint)(<span style="color:#458;font-weight:bold">int</span>)argv[<span style="color:#099">1</span>][counter]);
          puts(<span style="color:#d14">&#34;Wrong answer</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
          ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
          <span style="color:#000;font-weight:bold">goto</span> L_EXIT;
        }
	 	counter <span style="color:#000;font-weight:bold">=</span> counter <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
      }
      puts(<span style="color:#d14">&#34;Correct! You have the power!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please provide the password to enter castle greyskull!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
  }
  
<span style="color:#900;font-weight:bold">L_EXIT</span>:
  <span style="color:#000;font-weight:bold">if</span> (stack_canary <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">*</span>(<span style="color:#458;font-weight:bold">long</span> <span style="color:#000;font-weight:bold">*</span>)(in_FS_OFFSET <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">0x28</span>)) {
                    <span style="color:#998;font-style:italic">/* WARNING: Subroutine does not return */</span>
    __stack_chk_fail();
  }
  
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><p>There is also an information leak, when a byte differs betwwen input and password, it will be displayed as shown below:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#000;font-weight:bold">if</span> ((byte)(<span style="color:#d14">&#34;skeletor&#34;</span>[counter] <span style="color:#000;font-weight:bold">^</span> xor_values[counter]) <span style="color:#000;font-weight:bold">!=</span> argv[<span style="color:#099">1</span>][counter]) {
  printf(<span style="color:#d14">&#34;%c</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,(<span style="color:#458;font-weight:bold">char</span>)(xor_values[counter] <span style="color:#000;font-weight:bold">^</span> <span style="color:#d14">&#34;skeletor&#34;</span>[counter]));
  printf(<span style="color:#d14">&#34;%c</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,argv[<span style="color:#099">1</span>][counter]);
}
</code></pre></td></tr></table>
</div>
</div><p><img src="/ghidra_intro/Pasted%20image%2020210527110500.png" alt=""></p>
<p>Or, by reversing the encryption algorithm:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527105100.png" alt=""></p>
<h1 id="lecture-2">Lecture 2</h1>
<p>Review C constructs and their assembly representation:</p>
<ul>
<li>Heap memory</li>
<li>Function calls</li>
<li>Switch cases</li>
<li>Loops / iterations</li>
<li>Local and global variables</li>
</ul>
<p>Ghidra Toolbar:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526154246.png" alt=""></p>
<h3 id="program-startup">Program startup</h3>
<ul>
<li>Program startup and behavior is defined by the System V ABI
<ul>
<li>This determines how a program starts and is loaded!</li>
<li>Determines how information in the ELF header is parsed</li>
<li>We can use the information from this ABI to help us when reverse engineering</li>
</ul>
</li>
<li>Within the ELF header, there is an e_entry field, this field points to the <code>_start()</code> function
<ul>
<li><code>_start</code> is an initialization routine before that calls <code>main</code></li>
</ul>
</li>
</ul>
<h3 id="imports--exports">Imports / Exports</h3>
<p><strong>Imports</strong>: Libraries that are utilized by the target binary</p>
<ul>
<li>When importing a binary, users can also specify path for libraries that are imported</li>
</ul>
<p><strong>Exports</strong>: Exposed information about target binary for the OS loader</p>
<h3 id="function-signatures">Function signatures</h3>
<ul>
<li>Function signatures can be edited in Ghidra, altering:
<ul>
<li>Argument count</li>
<li>Argument types</li>
<li>Return values</li>
</ul>
</li>
<li>The C standard defines main as: <code>int main(int argc, char **argv)</code>
<ul>
<li>If you can’t find main, start with <code>_start</code></li>
</ul>
</li>
<li>Fixing the function signature can greatly improve decompiler output</li>
</ul>
<p>🔴 &gt; Edit Function Signature</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210526151007.png" alt=""></p>
<h3 id="graph-view">Graph View</h3>
<ul>
<li>When looking at multiple branches, graph view can be helpful</li>
<li>Graph view can be useful when determining control flow</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210526153533.png" alt=""></p>
<h3 id="calling-conventions">Calling Conventions</h3>
<ul>
<li>Calling conventions define how function calls are implemented
<ul>
<li>How arguments are passed to functions</li>
<li>How return values are passed back from functions</li>
<li>Defines stack management and register cleanup</li>
</ul>
</li>
<li>GNU/Linux x86-64 uses the System V AMD64 ABI</li>
<li>Calling convention defines the epilogue / prologue for functions
<ul>
<li>The prologue reserves space for variables on the stack</li>
<li>The epilogue cleans up the stack frame and returns it to it’s original state</li>
</ul>
</li>
</ul>
<h4 id="cdecl">cdecl</h4>
<ul>
<li><code>call</code> pushes the return address to the stack when called</li>
<li>The first 6 function parameters are passed in through registers
<ul>
<li>RDI, RSI, RDX, RCX, R8, R9</li>
<li>after this, parameters are passed using the stack (as in x86)</li>
</ul>
</li>
<li>The return address is popped off the stack and placed into RIP using the <code>ret</code> instruction</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210527224444.png" alt=""></p>
<h3 id="function-comparison">Function Comparison</h3>
<p>To view the function comparison window, highlight two functions,
then right click -&gt; Compare Selected Functions</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527224801.png" alt=""></p>
<h3 id="stack-vs-heap">Stack vs Heap</h3>
<p>Stack:</p>
<ul>
<li>No need to deallocate manually
<ul>
<li>Stack frame is destroyed when function returns</li>
</ul>
</li>
<li>Local variables only</li>
<li>Limited by stack size (OS dependent)</li>
</ul>
<p>Heap:</p>
<ul>
<li>Variables can be accessed globally</li>
<li>No limit in size (as far the OS can support)</li>
<li>Managed by user. Deallocate using <code>free(m)</code>
<ul>
<li>Memory leaks</li>
</ul>
</li>
</ul>
<h3 id="arrays">Arrays</h3>
<ul>
<li>Array accesses often utilize the <code>LEA</code> instruction
<ul>
<li>Which is actually an arithmetic operation (similar to <code>add</code>)</li>
<li>Loads the address of the memory calculation into the register</li>
<li>Doesn&rsquo;t dereference the value as <code>MOV</code> would do</li>
</ul>
</li>
</ul>
<h2 id="exercises-1">Exercises</h2>
<ul>
<li><input checked="" disabled="" type="checkbox"> control-flow-1</li>
<li><input checked="" disabled="" type="checkbox"> loop-example-1</li>
<li><input checked="" disabled="" type="checkbox"> variables-example</li>
<li><input checked="" disabled="" type="checkbox"> func-example-1</li>
<li><input checked="" disabled="" type="checkbox"> heap-example-1</li>
<li><input disabled="" type="checkbox"> array-example</li>
</ul>
<p><strong>Note</strong> You will need to mark these binaries as executable before trying to run them, ex: <code>chmod u+x control-flow-1</code></p>
<h3 id="exercise-control-flow-1">Exercise control-flow-1</h3>
<p>Searching for strings, it can help us locate the code blocks we are interested in:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527113636.png" alt=""></p>
<p>The number of arguments provided is checked and if it is OK, the two provided arguments are parsed as integers, as shown below using the <code>atoi</code> C library function:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527115810.png" alt=""></p>
<p>For the first check, it is required that <code>[rbp - 0x14] &lt; [rbp - 0x10]</code>, therefore <code>input2 &lt; input1</code>.
In order to bypass the second stage check, <code>(input2 &lt;&lt; 1) &gt;= input1</code></p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527120518.png" alt=""></p>
<p>At address <code>0x001006e7 - 0x001006e9</code>, the sum of input1 and input2 values provided is stored in <code>[rbp - 0xc]</code>. This value is then loaded and is compared with <code>0x63 = 99</code> after the value of <code>[rbp - 0x14]</code> is subtracted. Therefore, in order to bypass the check,  <code>(input1 + input2) - input1 &gt; 99 =&gt;&gt; input2 &gt; 99</code>.</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527121336.png" alt=""></p>
<p>Constraints:</p>
<ul>
<li><code>input1 &gt; input2</code></li>
<li><code>2 * input2 &gt;= input1</code></li>
<li><code>input2 &gt; 99</code></li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210527170500.png" alt=""></p>
<h3 id="exercise-loop-example-1">Exercise loop-example-1</h3>
<p>Length of argument should be 15 characters long:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527172311.png" alt=""></p>
<p>For each character of the argument provided, check if its ASCII code falls between <code>[0x40, 0x5a]</code> and increment <code>counter2</code> if it is.</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527181137.png" alt=""></p>
<p>If <code>counter2 = 0x8</code> at the end of the loop, the success message is printed:</p>
<p><img src="/ghidra_intro/Pasted%20image%2020210527172843.png" alt=""></p>
<p>Decompiled C code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc,<span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t length;
  <span style="color:#458;font-weight:bold">int</span> counter1;
  <span style="color:#458;font-weight:bold">int</span> counter2;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    <span style="color:#000;font-weight:bold">if</span> ((<span style="color:#458;font-weight:bold">int</span>)length <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0xf</span>) {
      counter2 <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
      counter1 <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
      <span style="color:#000;font-weight:bold">while</span> (counter1 <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">0xf</span>) {
        <span style="color:#000;font-weight:bold">if</span> ((<span style="color:#d14">&#39;@&#39;</span> <span style="color:#000;font-weight:bold">&lt;</span> argv[<span style="color:#099">1</span>][counter1]) <span style="color:#000;font-weight:bold">&amp;&amp;</span> (argv[<span style="color:#099">1</span>][counter1] <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#d14">&#39;[&#39;</span>)) {
          counter2 <span style="color:#000;font-weight:bold">=</span> counter2 <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
        }
        counter1 <span style="color:#000;font-weight:bold">=</span> counter1 <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
      }
      <span style="color:#000;font-weight:bold">if</span> (counter2 <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">8</span>) {
        puts(<span style="color:#d14">&#34;Congratulations, access granted!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      }
      <span style="color:#000;font-weight:bold">else</span> {
        puts(<span style="color:#d14">&#34;Not quite what we</span><span style="color:#d14">\&#39;</span><span style="color:#d14">re looking for ... maybe try again?</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      }
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      puts(<span style="color:#d14">&#34;Wrong length! Try again!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please provide a string!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="exercise-variables-example">Exercise variables-example</h3>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t length;
  <span style="color:#458;font-weight:bold">int</span> ptr_index;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    <span style="color:#000;font-weight:bold">if</span> (length <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">8</span>) {
      puts(<span style="color:#d14">&#34;Too short, try again!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    }
    ptr_index <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    <span style="color:#000;font-weight:bold">while</span> (ptr_index <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">8</span>) {
      <span style="color:#000;font-weight:bold">if</span> ((<span style="color:#458;font-weight:bold">char</span>)((<span style="color:#458;font-weight:bold">char</span>)((<span style="color:#458;font-weight:bold">long</span>)XorMe <span style="color:#000;font-weight:bold">&gt;&gt;</span> ((byte)(ptr_index <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">3</span>) <span style="color:#000;font-weight:bold">&amp;</span> <span style="color:#099">0x3f</span>)) <span style="color:#000;font-weight:bold">+</span> globalVar[ptr_index] <span style="color:#000;font-weight:bold">+</span>
                <span style="color:#d14">&#39;\x01&#39;</span>) <span style="color:#000;font-weight:bold">!=</span> argv[<span style="color:#099">1</span>][ptr_index]) {
        puts(<span style="color:#d14">&#34;Improper character in keycode detected, try again!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
      }
      ptr_index <span style="color:#000;font-weight:bold">=</span> ptr_index <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
    }
    puts(<span style="color:#d14">&#34;Proper keycode supplied, well done!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
  }
  <span style="color:#000;font-weight:bold">else</span> {
    printf(<span style="color:#d14">&#34;Please prvide the 8 character keycode&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><p>Solution code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdio.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdint.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span><span style="color:#999;font-weight:bold;font-style:italic"></span>
<span style="color:#999;font-weight:bold;font-style:italic">#ifndef DEBUG
</span><span style="color:#999;font-weight:bold;font-style:italic">#define DEBUG 0
</span><span style="color:#999;font-weight:bold;font-style:italic">#endif
</span><span style="color:#999;font-weight:bold;font-style:italic"></span>
<span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">void</span>)
{
	uint64_t w <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0xDEADBEEFFACECAFE</span>;
	<span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span> t <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;KeYpress&#34;</span>;

<span style="color:#999;font-weight:bold;font-style:italic">#if DEBUG
</span><span style="color:#999;font-weight:bold;font-style:italic"></span>	printf(<span style="color:#d14">&#34;%lX</span><span style="color:#d14">\n</span><span style="color:#d14">&#34;</span>, w);
<span style="color:#999;font-weight:bold;font-style:italic">#endif
</span><span style="color:#999;font-weight:bold;font-style:italic"></span>	<span style="color:#000;font-weight:bold">for</span> (<span style="color:#458;font-weight:bold">int</span> i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>; i <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">8</span>; i<span style="color:#000;font-weight:bold">++</span>) {
		printf(<span style="color:#d14">&#34;%c&#34;</span>, (<span style="color:#458;font-weight:bold">char</span>) ((<span style="color:#458;font-weight:bold">char</span>)(w <span style="color:#000;font-weight:bold">&gt;&gt;</span> ( i <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">3</span> )) <span style="color:#000;font-weight:bold">&amp;</span> <span style="color:#099">0xff</span>) <span style="color:#000;font-weight:bold">+</span> t[i] <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span> );
	}
	puts(<span style="color:#d14">&#34;&#34;</span>);
	<span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><p><img src="/ghidra_intro/Pasted%20image%2020210527223205.png" alt=""></p>
<h3 id="exercise-func-example-1">Exercise func-example-1</h3>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">
<span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>str_upper;
  <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>str_lower;
  size_t length1;
  size_t length2;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    str_upper <span style="color:#000;font-weight:bold">=</span> getUpperCase(argv[<span style="color:#099">1</span>]);
    str_lower <span style="color:#000;font-weight:bold">=</span> getLowerCase(argv[<span style="color:#099">1</span>]);
    length1 <span style="color:#000;font-weight:bold">=</span> strlen(str_upper);
    length2 <span style="color:#000;font-weight:bold">=</span> strlen(str_lower);
    <span style="color:#000;font-weight:bold">if</span> (length1 <span style="color:#000;font-weight:bold">==</span> length2) {
      puts(<span style="color:#d14">&#34;Passcode generator passed, good job!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      free(str_upper);
      free(str_lower);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    }
    <span style="color:#000;font-weight:bold">else</span> {
      puts(<span style="color:#d14">&#34;Passcode doesn</span><span style="color:#d14">\&#39;</span><span style="color:#d14">t have enough variety! Please try again</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
      free(str_upper);
      free(str_lower);
      ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
    }
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please generate a passcode for system usage!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="exercise-heap-example-1">Exercise heap-example-1</h3>
<p>Decompiled code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">**</span>argv)
{
  <span style="color:#458;font-weight:bold">int</span> ret_code;
  size_t length;
  <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>__ptr;
  <span style="color:#458;font-weight:bold">int</span> index;
  <span style="color:#458;font-weight:bold">int</span> upper_counter;
  
  <span style="color:#000;font-weight:bold">if</span> (argc <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">2</span>) {
    length <span style="color:#000;font-weight:bold">=</span> strlen(argv[<span style="color:#099">1</span>]);
    __ptr <span style="color:#000;font-weight:bold">=</span> (<span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>)calloc((<span style="color:#458;font-weight:bold">long</span>)(<span style="color:#458;font-weight:bold">int</span>)length,<span style="color:#099">1</span>);
    upper_counter <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    index <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
    <span style="color:#000;font-weight:bold">while</span> (index <span style="color:#000;font-weight:bold">&lt;</span> (<span style="color:#458;font-weight:bold">int</span>)length) {
      <span style="color:#000;font-weight:bold">if</span> ((<span style="color:#d14">&#39;@&#39;</span> <span style="color:#000;font-weight:bold">&lt;</span> argv[<span style="color:#099">1</span>][index]) <span style="color:#000;font-weight:bold">&amp;&amp;</span> (argv[<span style="color:#099">1</span>][index] <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#d14">&#39;[&#39;</span>)) {
        __ptr[upper_counter] <span style="color:#000;font-weight:bold">=</span> argv[<span style="color:#099">1</span>][index];
        upper_counter <span style="color:#000;font-weight:bold">=</span> upper_counter <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
      }
      index <span style="color:#000;font-weight:bold">=</span> index <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>;
    }
    <span style="color:#000;font-weight:bold">if</span> (upper_counter <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0xc</span>) {
      printf(<span style="color:#d14">&#34;The result is: %s</span><span style="color:#d14">\r\n</span><span style="color:#d14">&#34;</span>,__ptr);
    }
    <span style="color:#000;font-weight:bold">else</span> {
      puts(<span style="color:#d14">&#34;Not quite what we</span><span style="color:#d14">\&#39;</span><span style="color:#d14">re looking for ... maybe try again?</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    }
    free(__ptr);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
  }
  <span style="color:#000;font-weight:bold">else</span> {
    puts(<span style="color:#d14">&#34;Please provide a string!</span><span style="color:#d14">\r</span><span style="color:#d14">&#34;</span>);
    ret_code <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>;
  }
  <span style="color:#000;font-weight:bold">return</span> ret_code;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="exercise-array-example">Exercise array-example</h3>
<p>As I wasn&rsquo;t able to Reverse Engineer the code, I wrote a bruteforce script:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-python" data-lang="python"><span style="color:#998;font-style:italic">#!/usr/bin/env python3</span>

<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">string</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">subprocess</span>

ERR_MSG1 <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;Wrong value detected at character &#34;</span> 
ERR_MSG2 <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;Improper index provided&#34;</span>

<span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">main</span>():
    sols <span style="color:#000;font-weight:bold">=</span> []
    s <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;&#34;</span>
    cnt <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>
    p <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>
    <span style="color:#000;font-weight:bold">while</span> p <span style="color:#000;font-weight:bold">&lt;=</span> <span style="color:#099">5</span>:
        <span style="color:#000;font-weight:bold">for</span> c <span style="color:#000;font-weight:bold">in</span> (string<span style="color:#000;font-weight:bold">.</span>ascii_letters <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;0123456789&#34;</span> <span style="color:#000;font-weight:bold">+</span> string<span style="color:#000;font-weight:bold">.</span>punctuation):
            out, _ <span style="color:#000;font-weight:bold">=</span> subprocess<span style="color:#000;font-weight:bold">.</span>Popen([<span style="color:#d14">&#34;./array-example&#34;</span>, <span style="color:#0086b3">str</span>(p), s<span style="color:#000;font-weight:bold">+</span>c], stdout<span style="color:#000;font-weight:bold">=</span>subprocess<span style="color:#000;font-weight:bold">.</span>PIPE)<span style="color:#000;font-weight:bold">.</span>communicate()
            out <span style="color:#000;font-weight:bold">=</span> out<span style="color:#000;font-weight:bold">.</span>rstrip()<span style="color:#000;font-weight:bold">.</span>decode(<span style="color:#d14">&#39;utf-8&#39;</span>)
            <span style="color:#000;font-weight:bold">if</span> ERR_MSG1 <span style="color:#000;font-weight:bold">in</span> out:
                index <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">int</span>(out[<span style="color:#0086b3">len</span>(ERR_MSG):<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>], <span style="color:#099">16</span>)
                <span style="color:#000;font-weight:bold">if</span> index <span style="color:#000;font-weight:bold">&gt;</span> cnt:
                    s <span style="color:#000;font-weight:bold">+=</span> c
                    cnt <span style="color:#000;font-weight:bold">+=</span> <span style="color:#099">1</span>
                    <span style="color:#000;font-weight:bold">print</span>(<span style="color:#d14">&#34;[+] Iteration {} position {} =&gt; {}&#34;</span><span style="color:#000;font-weight:bold">.</span>format(p, cnt, c))
            <span style="color:#000;font-weight:bold">elif</span> ERR_MSG2 <span style="color:#000;font-weight:bold">in</span> out:
                <span style="color:#000;font-weight:bold">print</span>(sols)
                <span style="color:#0086b3">exit</span>(<span style="color:#099">0</span>)
            <span style="color:#000;font-weight:bold">else</span>: 
                sols<span style="color:#000;font-weight:bold">.</span>append(s)
                p <span style="color:#000;font-weight:bold">+=</span> <span style="color:#099">1</span>
                s <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;&#34;</span>
                cnt <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>

<span style="color:#000;font-weight:bold">if</span> __name__ <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;__main__&#39;</span>:
    main()

</code></pre></td></tr></table>
</div>
</div><h1 id="lecture-3">Lecture 3</h1>
<h3 id="structure-padding">Structure Padding</h3>
<ul>
<li>Elements in structures need to be byte aligned</li>
<li>Fields that are not byte aligned will be padded
<ul>
<li>This is to stop unaligned memory accesses
<ul>
<li>compiler optimization</li>
</ul>
</li>
<li><code>__attribute((packed))__</code></li>
</ul>
</li>
</ul>
<p>Structures can be added to Ghidra</p>
<ul>
<li>Import header files
<ul>
<li>File -&gt; Import C source</li>
</ul>
</li>
<li>Manual creation in struct creator
<ul>
<li>Data types manager</li>
</ul>
</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210528223548.png" alt=""></p>
<h3 id="pointers">Pointers</h3>
<ul>
<li>A pointer is a variable whose value is the address of a memory location</li>
<li>Indirect method of accessing memory</li>
<li>Pointers are of the same size, despite of the data they point to</li>
<li><code>LEA</code> instruction can be used for pointer arithmetic</li>
</ul>
<pre><code>MOV RAX, QWORD PTR [RBP - 0x18]
MOV RCX, [RAX]		; RCX = *((type *)RAX)
</code></pre><h3 id="x86_64-system-calls">x86_64 System Calls</h3>
<ul>
<li>Interface to communicate with the kernel
<ul>
<li>Operations that require privileged access</li>
<li><code>syscall</code> instruction</li>
</ul>
</li>
<li>OS implements a system call handler to catch when a <code>syscall</code> occurs</li>
<li>Information about requested syscall is passed through registers</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210529163903.png" alt=""></p>
<table>
<thead>
<tr>
<th style="text-align:left">Register</th>
<th style="text-align:left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">RAX</td>
<td style="text-align:left">NR_SYSCALL</td>
</tr>
<tr>
<td style="text-align:left">RCX</td>
<td style="text-align:left">Return Address</td>
</tr>
<tr>
<td style="text-align:left">R11</td>
<td style="text-align:left">Saved RFLAGS</td>
</tr>
<tr>
<td style="text-align:left">RDI</td>
<td style="text-align:left">ARG0</td>
</tr>
<tr>
<td style="text-align:left">RSI</td>
<td style="text-align:left">ARG1</td>
</tr>
<tr>
<td style="text-align:left">RDX</td>
<td style="text-align:left">ARG2</td>
</tr>
<tr>
<td style="text-align:left">R10</td>
<td style="text-align:left">ARG3</td>
</tr>
<tr>
<td style="text-align:left">R9</td>
<td style="text-align:left">ARG4</td>
</tr>
<tr>
<td style="text-align:left">R8</td>
<td style="text-align:left">ARG5</td>
</tr>
</tbody>
</table>
<p><img src="/ghidra_intro/Pasted%20image%2020210529113208.png" alt=""></p>
<h3 id="files">Files</h3>
<ul>
<li>system calls are used at a low level to perform file operations
<ul>
<li>libc provides wrapper functions</li>
</ul>
</li>
</ul>
<h3 id="binary-patching">Binary Patching</h3>
<ul>
<li>Includes an assembler to allow use of actual instructions</li>
<li>The export functionality is used to dump all initialized memory blocks within Ghidra
<ul>
<li>The result is not a valid ELF file</li>
<li>Can be used for FLAT firmware images</li>
</ul>
</li>
</ul>
<h3 id="searching">Searching</h3>
<p>When analyzing a program in Ghidra, you can search for various data types/patterns</p>
<ul>
<li>Instructions
<ul>
<li>Search for particular instruction</li>
</ul>
</li>
<li>Scalars (= Immediate values)
<ul>
<li>Search for immediate values</li>
</ul>
</li>
<li>Direct references
<ul>
<li>Search for particular address/location</li>
</ul>
</li>
<li>Instruction patterns
<ul>
<li>Search for sequences of instructions</li>
</ul>
</li>
<li>Strings
<ul>
<li>Search for defined strings</li>
</ul>
</li>
</ul>
<h2 id="exercises-2">Exercises</h2>
<ul>
<li><input disabled="" type="checkbox"> struct</li>
<li><input disabled="" type="checkbox"> pointers</li>
<li><input checked="" disabled="" type="checkbox"> syscall</li>
<li><input disabled="" type="checkbox"> files</li>
</ul>
<h3 id="exercise-struct">Exercise struct</h3>
<p>Using GDB:</p>
<h4 id="disassemble-main">Disassemble: main</h4>
<p><strong>Function prologue</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x000000000040070c</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">0</span><span style="color:#000;font-weight:bold">&gt;:</span>	push   rbp
   <span style="color:#099">0x000000000040070d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">1</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rbp,rsp
   <span style="color:#099">0x0000000000400710</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">4</span><span style="color:#000;font-weight:bold">&gt;:</span>	push   rbx
   <span style="color:#099">0x0000000000400711</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">5</span><span style="color:#000;font-weight:bold">&gt;:</span>	sub    rsp,<span style="color:#099">0x58</span>
</code></pre></td></tr></table>
</div>
</div><p>Creates the stack frame, and reserves 88 bytes on the stack</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#099">0x0000000000400715</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">9</span><span style="color:#000;font-weight:bold">&gt;:</span>    mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x54</span>],edi
<span style="color:#099">0x0000000000400718</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">12</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x60</span>],rsi
<span style="color:#099">0x000000000040071c</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">16</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x44</span>],<span style="color:#099">0x0</span>
<span style="color:#099">0x0000000000400723</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">23</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x54</span>],<span style="color:#099">0x4</span>
<span style="color:#099">0x0000000000400727</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">27</span><span style="color:#000;font-weight:bold">&gt;:</span>	je     <span style="color:#099">0x40073d</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">49</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>L_ARGC_ERR</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#900;font-weight:bold">L_ARGC_ERR</span>:
   <span style="color:#099">0x0000000000400729</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">29</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x400938</span>
   <span style="color:#099">0x000000000040072e</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">34</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400500</span> <span style="color:#000;font-weight:bold">&lt;</span>puts<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400733</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">39</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0xffffffff</span>
   <span style="color:#099">0x0000000000400738</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">44</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x40089f</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">403</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Stores the <code>argc</code> (edi : int = 4bytes) and <code>argv</code> (rsi: char ** = 8 bytes) at locations <code>[rbp - 0x54]</code> and <code>[rbp - 0x60]</code> respectively.</p>
<p>Then compares the number of arguments <code>argc</code> with four (4) and prints an error message if <code>argc != 4</code> and returns -1.</p>
<pre><code>(gdb) x/10s 0x400938
0x400938:	&quot;Please provide your key, username and password!\r\nExample: 12738 wrongbaud P@55W0rd1\r&quot;
</code></pre><div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x000000000040073d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">49</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x60</span>]
   <span style="color:#099">0x0000000000400741</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">53</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rax,<span style="color:#099">0x8</span>
   <span style="color:#099">0x0000000000400745</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">57</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rax]
   <span style="color:#099">0x0000000000400748</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">60</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x000000000040074b</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">63</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400550</span> <span style="color:#000;font-weight:bold">&lt;</span>atoi<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400750</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">68</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x44</span>],eax
   <span style="color:#099">0x0000000000400753</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">71</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x44</span>],<span style="color:#099">0x0</span>
   <span style="color:#099">0x0000000000400757</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">75</span><span style="color:#000;font-weight:bold">&gt;:</span>	jne    <span style="color:#099">0x40076d</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">97</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Loads the <code>argv</code> pointer stored in <code>[rbp - 0x60]</code> and adds 8, effectively accessing the <code>argv[1]</code> element. The first argument is loaded in <code>rdi</code> and then is given to <code>atoi</code> to parse it as integer. The result is stored in <code>[rbp - 0x44]</code> and if it is not zero a jump is made to address <code>0x40076d &lt;main + 97&gt;</code>.</p>
<p><strong>L_KEY_ERR</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#900;font-weight:bold">L_KEY_ERR</span>:
   <span style="color:#099">0x0000000000400759</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">77</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x400990</span>
   <span style="color:#099">0x000000000040075e</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">82</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400500</span> <span style="color:#000;font-weight:bold">&lt;</span>puts<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400763</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">87</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0xffffffff</span>
   <span style="color:#099">0x0000000000400768</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">92</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x40089f</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">403</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Else, it prints an error message and returns -1.</p>
<pre><code>(gdb) x/s 0x400990
0x400990:	&quot;Improper key provided, please provide an integer key!\r&quot;
</code></pre><p>Again <code>argv</code> stored in <code>[rbp - 0x60]</code> is loaded and <code>argv[2]</code> is effectively accessed by adding 16 bytes to the base pointer. <code>argv[2]</code> is now stored in <code>[rbp - 0x40]</code>. Then, the length of the 2nd argument is computed using <code>strlen</code> function and it should be <code>7 &lt; length &lt; 255</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x000000000040076d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">97</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x60</span>]
   <span style="color:#099">0x0000000000400771</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">101</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rax<span style="color:#000;font-weight:bold">+</span><span style="color:#099">0x10</span>]
   <span style="color:#099">0x0000000000400775</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">105</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x40</span>],rax
   <span style="color:#099">0x0000000000400779</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">109</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x40</span>]
   <span style="color:#099">0x000000000040077d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">113</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x0000000000400780</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">116</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400510</span> <span style="color:#000;font-weight:bold">&lt;</span>strlen<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400785</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">121</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    rax,<span style="color:#099">0x255</span>
   <span style="color:#099">0x000000000040078b</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">127</span><span style="color:#000;font-weight:bold">&gt;:</span>	ja     <span style="color:#099">0x40079f</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">147</span><span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x000000000040078d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">129</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x40</span>]
   <span style="color:#099">0x0000000000400791</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">133</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x0000000000400794</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">136</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400510</span> <span style="color:#000;font-weight:bold">&lt;</span>strlen<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400799</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">141</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    rax,<span style="color:#099">0x7</span>
   <span style="color:#099">0x000000000040079d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">145</span><span style="color:#000;font-weight:bold">&gt;:</span>	ja     <span style="color:#099">0x4007b3</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">167</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Else, an error message is printed and returns -1.</p>
<p><strong>L_USERNAME_ERR</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#900;font-weight:bold">L_USERNAME_ERR</span>:
   <span style="color:#099">0x000000000040079f</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">147</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x4009c8</span>
   <span style="color:#099">0x00000000004007a4</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">152</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400500</span> <span style="color:#000;font-weight:bold">&lt;</span>puts<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004007a9</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">157</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0xffffffff</span>
   <span style="color:#099">0x00000000004007ae</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">162</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x40089f</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">403</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>(gdb) x/s 0x4009c8
0x4009c8:	&quot;Improper username provided, please check the length!\r&quot;
</code></pre><p>Then, the 3rd argument <code>argv[3]</code> is accessed and stored in <code>[rbp - 0x38]</code>. Again, the length is computed, which should be <code>7 &lt; length &lt; 255</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x00000000004007b3</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">167</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x60</span>]
   <span style="color:#099">0x00000000004007b7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">171</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rax<span style="color:#000;font-weight:bold">+</span><span style="color:#099">0x18</span>]
   <span style="color:#099">0x00000000004007bb</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">175</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x38</span>],rax
   <span style="color:#099">0x00000000004007bf</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">179</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x38</span>]
   <span style="color:#099">0x00000000004007c3</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">183</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x00000000004007c6</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">186</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400510</span> <span style="color:#000;font-weight:bold">&lt;</span>strlen<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004007cb</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">191</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    rax,<span style="color:#099">0x255</span>
   <span style="color:#099">0x00000000004007d1</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">197</span><span style="color:#000;font-weight:bold">&gt;:</span>	ja     <span style="color:#099">0x4007e5</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">217</span><span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004007d3</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">199</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x38</span>]
   <span style="color:#099">0x00000000004007d7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">203</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x00000000004007da</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">206</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400510</span> <span style="color:#000;font-weight:bold">&lt;</span>strlen<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004007df</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">211</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    rax,<span style="color:#099">0x7</span>
   <span style="color:#099">0x00000000004007e3</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">215</span><span style="color:#000;font-weight:bold">&gt;:</span>	ja     <span style="color:#099">0x4007f9</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">237</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>L_PASSWORD_ERR</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#900;font-weight:bold">L_PASSWORD_ERR</span>:
   <span style="color:#099">0x00000000004007e5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">217</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x400a00</span>
   <span style="color:#099">0x00000000004007ea</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">222</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400500</span> <span style="color:#000;font-weight:bold">&lt;</span>puts<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004007ef</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">227</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0xffffffff</span>
   <span style="color:#099">0x00000000004007f4</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">232</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x40089f</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">403</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Else, an error message is printed and returns -1.</p>
<pre><code>(gdb) x/s 0x400a00
0x400a00:	&quot;Improper password provided, please check the length!\r&quot;
</code></pre><div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x00000000004007f9</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">237</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x44</span>] ; atoi(argv[<span style="color:#099">1</span>])
   <span style="color:#099">0x00000000004007fc</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">240</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x30</span>],eax
   <span style="color:#099">0x00000000004007ff</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">243</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edx,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x30</span>]
   <span style="color:#099">0x0000000000400802</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">246</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x30</span>]
   <span style="color:#099">0x0000000000400805</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">249</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    esi,edx
   <span style="color:#099">0x0000000000400807</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">251</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,eax
   <span style="color:#099">0x0000000000400809</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">253</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x40064d</span> <span style="color:#000;font-weight:bold">&lt;</span>add<span style="color:#000;font-weight:bold">&gt;</span>
   
   <span style="color:#099">0x000000000040080e</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">258</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x18</span>],eax
   <span style="color:#099">0x0000000000400811</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">261</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x40</span>] ; arv[<span style="color:#099">2</span>]
   <span style="color:#099">0x0000000000400815</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">265</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x28</span>],rax
   <span style="color:#099">0x0000000000400819</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">269</span><span style="color:#000;font-weight:bold">&gt;:</span>	lea    rax,[rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x30</span>]
   <span style="color:#099">0x000000000040081d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">273</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x0000000000400820</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">276</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400661</span> <span style="color:#000;font-weight:bold">&lt;</span>gen_password<span style="color:#000;font-weight:bold">&gt;</span>
   
   <span style="color:#099">0x0000000000400825</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">281</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x48</span>],<span style="color:#099">0x0</span>
   <span style="color:#099">0x000000000040082c</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">288</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x48</span>],<span style="color:#099">0x0</span>
   <span style="color:#099">0x0000000000400833</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">295</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x40086d</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">353</span><span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400835</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">297</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x48</span>]
   <span style="color:#099">0x0000000000400838</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">300</span><span style="color:#000;font-weight:bold">&gt;:</span>	movsxd rdx,eax
   <span style="color:#099">0x000000000040083b</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">303</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x38</span>]
   <span style="color:#099">0x000000000040083f</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">307</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rax,rdx
   <span style="color:#099">0x0000000000400842</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">310</span><span style="color:#000;font-weight:bold">&gt;:</span>	movzx  edx,BYTE PTR [rax]
   <span style="color:#099">0x0000000000400845</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">313</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rcx,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x20</span>]
   <span style="color:#099">0x0000000000400849</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">317</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x48</span>]
   <span style="color:#099">0x000000000040084c</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">320</span><span style="color:#000;font-weight:bold">&gt;:</span>	cdqe   
   <span style="color:#099">0x000000000040084e</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">322</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rax,rcx
   <span style="color:#099">0x0000000000400851</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">325</span><span style="color:#000;font-weight:bold">&gt;:</span>	movzx  eax,BYTE PTR [rax]
   <span style="color:#099">0x0000000000400854</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">328</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    dl,al
   <span style="color:#099">0x0000000000400856</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">330</span><span style="color:#000;font-weight:bold">&gt;:</span>	je     <span style="color:#099">0x400869</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">349</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>L_CHAR_ERR</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#900;font-weight:bold">L_CHAR_ERR</span>:
   <span style="color:#099">0x0000000000400858</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">332</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x400a38</span>
   <span style="color:#099">0x000000000040085d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">337</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400500</span> <span style="color:#000;font-weight:bold">&lt;</span>puts<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400862</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">342</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0xffffffff</span>
   <span style="color:#099">0x0000000000400867</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">347</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x40089f</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">403</span><span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400869</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">349</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x48</span>],<span style="color:#099">0x1</span>
   <span style="color:#099">0x000000000040086d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">353</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x48</span>]
   <span style="color:#099">0x0000000000400870</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">356</span><span style="color:#000;font-weight:bold">&gt;:</span>	movsxd rbx,eax
   <span style="color:#099">0x0000000000400873</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">359</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x20</span>]
   <span style="color:#099">0x0000000000400877</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">363</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x000000000040087a</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">366</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400510</span> <span style="color:#000;font-weight:bold">&lt;</span>strlen<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x000000000040087f</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">371</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    rbx,rax
   <span style="color:#099">0x0000000000400882</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">374</span><span style="color:#000;font-weight:bold">&gt;:</span>	jb     <span style="color:#099">0x400835</span> <span style="color:#000;font-weight:bold">&lt;</span>main<span style="color:#000;font-weight:bold">+</span><span style="color:#099">297</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>L_SUCCESS</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c"><span style="color:#900;font-weight:bold">L_SUCCESS</span>:
   <span style="color:#099">0x0000000000400884</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">376</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x400a6e</span>
   <span style="color:#099">0x0000000000400889</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">381</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400500</span> <span style="color:#000;font-weight:bold">&lt;</span>puts<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x000000000040088e</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">386</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x20</span>]
   <span style="color:#099">0x0000000000400892</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">390</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x0000000000400895</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">393</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x4004f0</span> <span style="color:#000;font-weight:bold">&lt;</span>free<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x000000000040089a</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">398</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0x0</span>
   <span style="color:#099">0x000000000040089f</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">403</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rsp,<span style="color:#099">0x58</span>
   <span style="color:#099">0x00000000004008a3</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">407</span><span style="color:#000;font-weight:bold">&gt;:</span>	pop    rbx
   <span style="color:#099">0x00000000004008a4</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">408</span><span style="color:#000;font-weight:bold">&gt;:</span>	pop    rbp
   <span style="color:#099">0x00000000004008a5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">409</span><span style="color:#000;font-weight:bold">&gt;:</span>	ret    
</code></pre></td></tr></table>
</div>
</div><h4 id="disassemble-gen_password">Disassemble: gen_password</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x0000000000400661</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">0</span><span style="color:#000;font-weight:bold">&gt;:</span>	    push   rbp
   <span style="color:#099">0x0000000000400662</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">1</span><span style="color:#000;font-weight:bold">&gt;:</span>	    mov    rbp,rsp
   <span style="color:#099">0x0000000000400665</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">4</span><span style="color:#000;font-weight:bold">&gt;:</span>	    sub    rsp,<span style="color:#099">0x20</span>
   <span style="color:#099">0x0000000000400669</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">8</span><span style="color:#000;font-weight:bold">&gt;:</span>	    mov    QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x18</span>],rdi
   <span style="color:#099">0x000000000040066d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">12</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x18</span>]
   <span style="color:#099">0x0000000000400671</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">16</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rax<span style="color:#000;font-weight:bold">+</span><span style="color:#099">0x8</span>]
   <span style="color:#099">0x0000000000400675</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">20</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x0000000000400678</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">23</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400510</span> <span style="color:#000;font-weight:bold">&lt;</span>strlen<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x000000000040067d</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">28</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0xc</span>],eax
   <span style="color:#099">0x0000000000400680</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">31</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>],<span style="color:#099">0x0</span>
   <span style="color:#099">0x0000000000400687</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">38</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0xc</span>]
   <span style="color:#099">0x000000000040068a</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">41</span><span style="color:#000;font-weight:bold">&gt;:</span>	cdqe   
   <span style="color:#099">0x000000000040068c</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">43</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,rax
   <span style="color:#099">0x000000000040068f</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">46</span><span style="color:#000;font-weight:bold">&gt;:</span>	call   <span style="color:#099">0x400540</span> <span style="color:#000;font-weight:bold">&lt;</span>malloc<span style="color:#a61717;background-color:#e3d2d2">@</span>plt<span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x0000000000400694</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">51</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x8</span>],rax
   <span style="color:#099">0x0000000000400698</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">55</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>],<span style="color:#099">0x0</span>
   <span style="color:#099">0x000000000040069f</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">62</span><span style="color:#000;font-weight:bold">&gt;:</span>	jmp    <span style="color:#099">0x4006f1</span> <span style="color:#000;font-weight:bold">&lt;</span>gen_password<span style="color:#000;font-weight:bold">+</span><span style="color:#099">144</span><span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004006a1</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">64</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>]
   <span style="color:#099">0x00000000004006a4</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">67</span><span style="color:#000;font-weight:bold">&gt;:</span>	movsxd rdx,eax
   <span style="color:#099">0x00000000004006a7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">70</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x8</span>]
   <span style="color:#099">0x00000000004006ab</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">74</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rdx,rax
   <span style="color:#099">0x00000000004006ae</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">77</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x18</span>]
   <span style="color:#099">0x00000000004006b2</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">81</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rcx,QWORD PTR [rax<span style="color:#000;font-weight:bold">+</span><span style="color:#099">0x8</span>]
   <span style="color:#099">0x00000000004006b6</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">85</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>]
   <span style="color:#099">0x00000000004006b9</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">88</span><span style="color:#000;font-weight:bold">&gt;:</span>	cdqe   
   <span style="color:#099">0x00000000004006bb</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">90</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rax,rcx
   <span style="color:#099">0x00000000004006be</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">93</span><span style="color:#000;font-weight:bold">&gt;:</span>	movzx  ecx,BYTE PTR [rax]
   <span style="color:#099">0x00000000004006c1</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">96</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x18</span>]
   <span style="color:#099">0x00000000004006c5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">100</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rax]
   <span style="color:#099">0x00000000004006c7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">102</span><span style="color:#000;font-weight:bold">&gt;:</span>	xor    eax,ecx
   <span style="color:#099">0x00000000004006c9</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">104</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    BYTE PTR [rdx],al
   <span style="color:#099">0x00000000004006cb</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">106</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>]
   <span style="color:#099">0x00000000004006ce</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">109</span><span style="color:#000;font-weight:bold">&gt;:</span>	movsxd rdx,eax
   <span style="color:#099">0x00000000004006d1</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">112</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x8</span>]
   <span style="color:#099">0x00000000004006d5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">116</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rdx,rax
   <span style="color:#099">0x00000000004006d8</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">119</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>]
   <span style="color:#099">0x00000000004006db</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">122</span><span style="color:#000;font-weight:bold">&gt;:</span>	movsxd rcx,eax
   <span style="color:#099">0x00000000004006de</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">125</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x8</span>]
   <span style="color:#099">0x00000000004006e2</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">129</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    rax,rcx
   <span style="color:#099">0x00000000004006e5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">132</span><span style="color:#000;font-weight:bold">&gt;:</span>	movzx  eax,BYTE PTR [rax]
   <span style="color:#099">0x00000000004006e8</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">135</span><span style="color:#000;font-weight:bold">&gt;:</span>	sub    eax,<span style="color:#099">0x13</span>
   <span style="color:#099">0x00000000004006eb</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">138</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    BYTE PTR [rdx],al
   <span style="color:#099">0x00000000004006ed</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">140</span><span style="color:#000;font-weight:bold">&gt;:</span>	add    DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>],<span style="color:#099">0x1</span>
   <span style="color:#099">0x00000000004006f1</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">144</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x10</span>]
   <span style="color:#099">0x00000000004006f4</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">147</span><span style="color:#000;font-weight:bold">&gt;:</span>	cmp    eax,DWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0xc</span>]
   <span style="color:#099">0x00000000004006f7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">150</span><span style="color:#000;font-weight:bold">&gt;:</span>	jl     <span style="color:#099">0x4006a1</span> <span style="color:#000;font-weight:bold">&lt;</span>gen_password<span style="color:#000;font-weight:bold">+</span><span style="color:#099">64</span><span style="color:#000;font-weight:bold">&gt;</span>
   <span style="color:#099">0x00000000004006f9</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">152</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rax,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x18</span>]
   <span style="color:#099">0x00000000004006fd</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">156</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdx,QWORD PTR [rbp<span style="color:#000;font-weight:bold">-</span><span style="color:#099">0x8</span>]
   <span style="color:#099">0x0000000000400701</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">160</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR [rax<span style="color:#000;font-weight:bold">+</span><span style="color:#099">0x10</span>],rdx
   <span style="color:#099">0x0000000000400705</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">164</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0x0</span>
   <span style="color:#099">0x000000000040070a</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">169</span><span style="color:#000;font-weight:bold">&gt;:</span>	leave  
   <span style="color:#099">0x000000000040070b</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">170</span><span style="color:#000;font-weight:bold">&gt;:</span>	ret    
</code></pre></td></tr></table>
</div>
</div><h3 id="exercise-syscall">Exercise syscall</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-c" data-lang="c">   <span style="color:#099">0x00000000004000b0</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">0</span><span style="color:#000;font-weight:bold">&gt;:</span>	    mov    eax,<span style="color:#099">0x2</span>			; open syscall
   <span style="color:#099">0x00000000004000b5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">5</span><span style="color:#000;font-weight:bold">&gt;:</span>	    movabs rdi,<span style="color:#099">0x600124</span>		; syscalls.txt	
   <span style="color:#099">0x00000000004000bf</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">15</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rsi,QWORD PTR <span style="color:#900;font-weight:bold">ds</span>:<span style="color:#099">0x600131</span>
   <span style="color:#099">0x00000000004000c7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">23</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdx,QWORD PTR <span style="color:#900;font-weight:bold">ds</span>:<span style="color:#099">0x600139</span>
   <span style="color:#099">0x00000000004000cf</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">31</span><span style="color:#000;font-weight:bold">&gt;:</span>	syscall 				; open(<span style="color:#d14">&#34;syscalls.txt&#34;</span>, ...)
   <span style="color:#099">0x00000000004000d1</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">33</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    QWORD PTR <span style="color:#900;font-weight:bold">ds</span>:<span style="color:#099">0x600141</span>,rax
   <span style="color:#099">0x00000000004000d9</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">41</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0x1</span>			; write syscall
   <span style="color:#099">0x00000000004000de</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">46</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,QWORD PTR <span style="color:#900;font-weight:bold">ds</span>:<span style="color:#099">0x600141</span>
   <span style="color:#099">0x00000000004000e6</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">54</span><span style="color:#000;font-weight:bold">&gt;:</span>	movabs rsi,<span style="color:#099">0x400114</span>
   <span style="color:#099">0x00000000004000f0</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">64</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edx,<span style="color:#099">0xe</span>          ; write count
   <span style="color:#099">0x00000000004000f5</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">69</span><span style="color:#000;font-weight:bold">&gt;:</span>	syscall  				; write(fd, <span style="color:#d14">&#34;hello-hackaday&#34;</span>, <span style="color:#099">14</span>)
   <span style="color:#099">0x00000000004000f7</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">71</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0x3</span>     		; close syscall    
   <span style="color:#099">0x00000000004000fc</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">76</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    rdi,QWORD PTR <span style="color:#900;font-weight:bold">ds</span>:<span style="color:#099">0x600141</span>
   <span style="color:#099">0x0000000000400104</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">84</span><span style="color:#000;font-weight:bold">&gt;:</span>	syscall 
   <span style="color:#099">0x0000000000400106</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">86</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    edi,<span style="color:#099">0x0</span>
   <span style="color:#099">0x000000000040010b</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">91</span><span style="color:#000;font-weight:bold">&gt;:</span>	mov    eax,<span style="color:#099">0x3c</span> 		; exit syscall
   <span style="color:#099">0x0000000000400110</span> <span style="color:#000;font-weight:bold">&lt;+</span><span style="color:#099">96</span><span style="color:#000;font-weight:bold">&gt;:</span>	syscall					; exit(<span style="color:#099">0</span>)
</code></pre></td></tr></table>
</div>
</div><h1 id="lecture-4">Lecture 4</h1>
<h3 id="external-libraries">External Libraries</h3>
<ul>
<li>Ghidra can be used to analyze external libraries utilized by your target binary</li>
<li>Ghidra can import and analyze these external libraries</li>
<li>Loading external libraries can assist with auto analysis
<ul>
<li>Type recognition and function prototype generation</li>
</ul>
</li>
</ul>
<h3 id="patch-diffing">Patch Diffing</h3>
<ul>
<li>Ghidra allows for version tracking of all imported binaries</li>
<li>Version Tracking</li>
<li>Ghidra: Version Tracking: <a href="https://www.youtube.com/watch?v=K83T7iVla5s">https://www.youtube.com/watch?v=K83T7iVla5s</a></li>
<li>Ghidra: Patch Diffing libPNG (via Version Tracking Tool): <a href="https://www.youtube.com/watch?v=w-9K20lILEk">https://www.youtube.com/watch?v=w-9K20lILEk</a></li>
</ul>
<h3 id="memory-manager">Memory Manager</h3>
<ul>
<li>Memory regions can be added manually via Ghidra’s Memory Map tool
<ul>
<li>Often used when analyzing firmware images</li>
<li>Programs can be rebased</li>
</ul>
</li>
<li>Memory regions can be added manually via Ghidra’s Memory Map tool
<ul>
<li>Start address</li>
<li>Size/End address</li>
<li>RWX flags</li>
<li>Overlay</li>
</ul>
</li>
<li>Binary files can be imported into memory regions
<ul>
<li>This is useful for RAM dumps if you can acquire them!</li>
<li>File -&gt; Add to Program</li>
</ul>
</li>
<li>Some memory regions can be set up as overlay blocks
<ul>
<li>Useful for older consoles with regions that can be bank switched</li>
</ul>
</li>
</ul>
<h3 id="sleigh">SLEIGH</h3>
<ul>
<li>SLEIGH specifies the translation from assembly code to P-Code</li>
<li>SLEIGH is the language that is used to create processor modules for Ghidra</li>
<li>Each processor definition will consist of the following files:
<ul>
<li>CPU.cspec ==&gt; Compiler Specification</li>
<li>CPU.ldefs ==&gt; Language definitions</li>
<li>CPU.pspec ==&gt; Processor Specification</li>
<li>CPU.slaspec ==&gt; SLEIGH Specification</li>
</ul>
</li>
<li>Examples can be found at: <a href="https://github.com/NationalSecurityAgency/ghidra/tree/master/Ghidra/Processors">https://github.com/NationalSecurityAgency/ghidra/tree/master/Ghidra/Processors</a></li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210601111042.png" alt=""></p>
<p>LDEFS</p>
<ul>
<li>Language definitions</li>
<li>Include endianess, size, etc</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210601111111.png" alt=""></p>
<p>PSPEC</p>
<ul>
<li>Processor Specification</li>
<li>Program Counter</li>
<li>Reset Vectors</li>
<li>Interrupt Handlers</li>
<li>Memory Mapped IO</li>
</ul>
<p>CSPEC</p>
<ul>
<li>Compiler Specification</li>
<li>Sizes for datatypes</li>
<li>Alignment rules</li>
<li>Stack growth</li>
<li>Function prototypes</li>
<li>Calling conventions</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210601111144.png" alt=""></p>
<p>SLASPEC</p>
<ul>
<li>SLEIGH specification</li>
<li>Alignment definitions</li>
<li>Address space definitions</li>
<li>Register definitions</li>
<li>Instruction definitions</li>
<li>Defines HOW instructions are decoded / disassembled
<ul>
<li>Defines parameters for disassembly</li>
<li>Defines how instructions are show in the listing</li>
</ul>
</li>
</ul>
<h3 id="p-code">P-code</h3>
<ul>
<li>Capable of modeling a general purpose processor
<ul>
<li>Register Transfer Language</li>
<li>Abstraction layer for CPU specific functions</li>
<li>Intermediate representation of Assembly code</li>
</ul>
</li>
<li>P-code is generated during initial analysis process</li>
<li>P-code is used to generate decompiled code</li>
</ul>
<h3 id="ghidra-extensions">Ghidra Extensions</h3>
<ul>
<li>Ghidra can be extended via plugins
<ul>
<li>Loaders</li>
<li>Scripts</li>
<li>Modules</li>
</ul>
</li>
<li>Ghidra provides both a Java and Python API
<ul>
<li>Requires the pydev plugin for eclipse integration</li>
</ul>
</li>
</ul>
<h3 id="ghidra-scripting">Ghidra Scripting</h3>
<p>Ghidra utilizes the Address datatype heavily within it’s API</p>
<ul>
<li>currentAddress returns an Address object</li>
<li>Address objects can NOT be treated like integers
<ul>
<li>Methods for arithmetic operations</li>
</ul>
</li>
<li>Address objects can be created using the AddressFactory</li>
</ul>
<p>Data can be generated automatically via scripting</p>
<ul>
<li>createByte(currentAddress)</li>
<li>createChar(currentAddress)</li>
<li>createDWord(currentAddress)</li>
<li>createAsciiString(currentAddress)</li>
</ul>
<p>Ghidra scripts can parse and operate at the instruction level</p>
<ul>
<li>getInstructionAt(address)
<ul>
<li>Used to get an Instruction object representing the instruction at that address</li>
</ul>
</li>
<li>Instruction Object
<ul>
<li>Number of operands</li>
<li>P-code representation</li>
<li>Operand objects (scalars, &hellip;)</li>
</ul>
</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210529133842.png" alt=""></p>
<p>Ghidra’s FlatProgramAPI can be used to create and modify functions</p>
<ul>
<li>Set signature, parameters, &hellip;</li>
<li>Func = getFunctionAt(address)</li>
<li>createFunction(address)</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210529133720.png" alt=""></p>
<p>Pcode objects can be accessed from instruction objects</p>
<ul>
<li>Inst.getPcode()</li>
<li>PcodeOps describe the Pcode operations for a given instruction</li>
<li>PcodeOps can be emulated using Ghidra’s Pcode emulator</li>
</ul>
<p><img src="/ghidra_intro/Pasted%20image%2020210529133637.png" alt=""></p>
<hr>
<h1 id="resources">Resources</h1>
<h2 id="faq">FAQ</h2>
<p>Do you have any resources for extracting binaries from a platform/uC?
<a href="https://wrongbaud.github.io/">https://wrongbaud.github.io</a></p>
<ul>
<li><a href="https://wrongbaud.github.io/jtag-hdd/">JTAG</a></li>
<li><a href="https://wrongbaud.github.io/stm-xbox-jtag/">SWD</a></li>
<li><a href="https://wrongbaud.github.io/router-teardown/">SPI Flash</a></li>
<li><a href="https://wrongbaud.github.io/Holiday-Teardown/">Parallel Flash</a></li>
</ul>
<p>When looking at firmware blobs, properly creating a memory map is very important, and may be the reason why you’re having issues with XRefs.. This can be done from within ghidra by clicking on the memory viewer, or by writing a <a href="https://wrongbaud.github.io/writing-a-ghidra-loader/">loader / script</a> to perform this for you. It is important to also create relevant RAM regions when working with firmware images as these are often where the XRefs will be located.</p>
<p>ABI = Application Binary Interface, this is what is used to determine things like calling conventions, object file formats and executable formats.</p>
<p>Why there is EAX if its a 64-bit file? e.g TEST EAX, EAX, shouldn&rsquo;t it be TEST RAX, RAX?</p>
<ul>
<li>This is likely a compiler optimization, writing a 32 bit register implicitly zero-extends in x86_64.</li>
</ul>
<h2 id="tips">Tips</h2>
<table>
<thead>
<tr>
<th>Description</th>
<th>Tip</th>
</tr>
</thead>
<tbody>
<tr>
<td>Keybindings to actions</td>
<td><img src="/ghidra_intro/Pasted%20image%2020210528191837.png" alt=""></td>
</tr>
<tr>
<td>Memory overlays (useful in Embedded systems)</td>
<td><img src="/ghidra_intro/Pasted%20image%2020210528191951.png" alt=""></td>
</tr>
<tr>
<td>Comment hyperlinks</td>
<td><img src="/ghidra_intro/Pasted%20image%2020210528192143.png" alt=""></td>
</tr>
</tbody>
</table>
<h2 id="study-materials">Study materials</h2>
<ul>
<li><a href="https://www.learn-c.org/">C Programming Language Review and Tutorials</a></li>
<li><a href="https://software.intel.com/content/www/us/en/develop/articles/introduction-to-x64-assembly.html">Introduction to 64 Bit Assembly</a></li>
<li><a href="https://www.cs.uaf.edu/2017/fall/cs301/reference/x86_64.html">NASM x86_64 Cheat Sheet</a></li>
<li><a href="https://cs.lmu.edu/~ray/notes/x86overview/">Excellent x86 Review</a></li>
<li><a href="https://software.intel.com/sites/default/files/managed/a4/60/253665-sdm-vol-1.pdf">Intel Manual - Volume 1</a></li>
<li><a href="https://software.intel.com/sites/default/files/managed/a4/60/325383-sdm-vol-2abcd.pdf">Intel Manual - Volume 2</a></li>
<li><a href="https://godbolt.org/">Online compiler with assembly output</a></li>
<li><a href="https://ghidra.re/online-courses/">https://ghidra.re/online-courses/</a></li>
<li><a href="https://ghidra-sre.org/CheatSheet.html">https://ghidra-sre.org/CheatSheet.html</a></li>
<li><a href="https://guedou.github.io/talks/2019_BeeRump/slides.pdf">https://guedou.github.io/talks/2019_BeeRump/slides.pdf</a></li>
<li><a href="https://github.com/NationalSecurityAgency/ghidra/tree/master/Ghidra/Processors">https://github.com/NationalSecurityAgency/ghidra/tree/master/Ghidra/Processors</a></li>
</ul>
<h2 id="tools">Tools</h2>
<ul>
<li><a href="https://github.com/d3v1l401/FindCrypt-Ghidra">https://github.com/d3v1l401/FindCrypt-Ghidra</a></li>
<li><a href="https://filippo.io/linux-syscall-table/">https://filippo.io/linux-syscall-table/</a></li>
<li><a href="https://github.com/Ebiroll/ghidra-xtensa">https://github.com/Ebiroll/ghidra-xtensa</a></li>
</ul>

  </div>

  
<div>
  <ul class="tags">
  <li>
    <a href="https://mxpapad.me/tags/ghidra/" class="tag-link">ghidra</a>
  </li>
  
  <li>
    <a href="https://mxpapad.me/tags/sre/" class="tag-link">sre</a>
  </li>
  
  <li>
    <a href="https://mxpapad.me/tags/reversing/" class="tag-link">reversing</a>
  </li>
  
  <li>
    <a href="https://mxpapad.me/tags/hackadayu/" class="tag-link">hackadayu</a>
  </li>
  </ul>
</div>



  <div class="share-buttons">
  <a class="twitter-share-button"
     href="#"
     title="Share on Twitter"
     data-url="https://mxpapad.me/posts/ghidra_intro/ghidra_intro/"
     data-text="HackadayU - Introduction to Reverse Engineering with Ghidra"><i class="fab fa-twitter"></i></a>

  <a class="linkedin-share-button"
     href="#"
     title="Share on LinkedIn"
     data-url="https://mxpapad.me/posts/ghidra_intro/ghidra_intro/"
     data-text="HackadayU - Introduction to Reverse Engineering with Ghidra"><i class="fab fa-linkedin-in"></i></a>

  <a class="facebook-share-button"
     href="#"
     title="Share on Facebook"
     data-url="https://mxpapad.me/posts/ghidra_intro/ghidra_intro/"
     data-text="HackadayU - Introduction to Reverse Engineering with Ghidra"><i class="fab fa-facebook"></i></a>

  <a class="telegram-share-button"
     href="#"
     title="Share on Telegram"
     data-url="https://mxpapad.me/posts/ghidra_intro/ghidra_intro/"
     data-text="HackadayU - Introduction to Reverse Engineering with Ghidra"><i class="fab fa-telegram"></i></a>

  <a class="pinterest-share-button"
     href="#"
     title="Share on Pinterest"
     data-url="https://mxpapad.me/posts/ghidra_intro/ghidra_intro/"
     data-text="HackadayU - Introduction to Reverse Engineering with Ghidra"><i class="fab fa-pinterest"></i></a>
</div>


  
</div>
  </main>

  <footer>
  <div>
    <p>
      &copy; ishtar 2021

      &middot; <a href="https://creativecommons.org/licenses/by-sa/4.0" target="_blank">CC BY-SA 4.0</a>

      
    </p>
  </div>
</footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
          integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
          crossorigin="anonymous"></script>


  <script src="/js/jquery.min.js"></script>
  <script src="/js/soho.js"></script>

  

  
</body>
</html>
