<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>SOVA :: Android Malware Analysis</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Static analysis of the SOVA Android Malware" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/sova/" />






  
  
  
  
  
  <link rel="stylesheet" href="/style.css">







  <link rel="shortcut icon" href="/img/theme-colors/orange.png">
  <link rel="apple-touch-icon" href="/img/theme-colors/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="SOVA">
<meta property="og:description" content="Static analysis of the SOVA Android Malware" />
<meta property="og:url" content="/sova/" />
<meta property="og:site_name" content="Android Malware Analysis" />

  
    <meta property="og:image" content="img/favicon/%!s().png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">













</head>
<body class="">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
  </div>
  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/sova/">SOVA</a>
  </h1>
  <div class="post-meta">
    
    
    
  </div>

  
  


    <div class="table-of-contents">
      <h2>
        Table of Contents
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#static-analysis---androidmanifestxml">Static Analysis - AndroidManifest.xml</a>
          <ul>
            <li>
              <ul>
                <li><a href="#package-name">Package Name</a></li>
                <li><a href="#required-permissions">Required Permissions</a></li>
                <li><a href="#declaration-of-the-application">Declaration of the Application</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#static-analysis---dive-deeper">Static Analysis - Dive Deeper</a>
          <ul>
            <li>
              <ul>
                <li><a href="#content-provider">Content Provider</a></li>
                <li><a href="#received-sms">Received SMS</a></li>
                <li><a href="#main-activity">Main Activity</a></li>
                <li><a href="#accessibility-service">Accessibility Service</a></li>
                <li><a href="#notification-service">Notification Service</a></li>
                <li><a href="#device-admin">Device Admin</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

  <div class="post-content"><div>
        <h2 id="static-analysis---androidmanifestxml">Static Analysis - AndroidManifest.xml<a href="#static-analysis---androidmanifestxml" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h4 id="package-name">Package Name<a href="#package-name" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;manifest</span> ... package=<span style="color:#2aa198">&#34;com.bean.cousin&#34;</span> <span style="color:#268bd2">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-sdk</span> android:minSdkVersion=<span style="color:#2aa198">&#34;24&#34;</span> android:targetSdkVersion=<span style="color:#2aa198">&#34;32&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span></code></pre></div><p>The application package is: <code>com.bean.cousin</code></p>
<h4 id="required-permissions">Required Permissions<a href="#required-permissions" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-feature</span> android:name=<span style="color:#2aa198">&#34;android.hardware.telephony&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.WAKE_LOCK&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.QUERY_ALL_PACKAGES&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACCESS_WIFI_STATE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACCESS_NETWORK_STATE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.RECEIVE_BOOT_COMPLETED&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.USE_FINGERPRINT&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.GET_TASKS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;com.google.android.gms.permission.ACTIVITY_RECOGNITION&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_EXTERNAL_STORAGE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.RECEIVE_LAUNCH_BROADCASTS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.REQUEST_DELETE_PACKAGES&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACTION_MANAGE_OVERLAY_PERMISSION&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.CALL_PHONE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.WRITE_SETTINGS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACCESS_BACKGROUND_LOCATION&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.RECEIVE_SMS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.QUICKBOOT_POWERON&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.RECORD_AUDIO&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.FOREGROUND_SERVICE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.BLUETOOTH&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.GET_ACCOUNTS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.CHANGE_NETWORK_STATE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.CLEAR_APP_CACHE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.INTERNET&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_CONTACTS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_EXTERNAL_STORAGE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_PHONE_STATE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACCESS_COARSE_LOCATION&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.INSTALL_PACKAGES&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.QUERY_ALL_PACKAGES&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACCESS_FINE_LOCATION&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_SMS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_PHONE_NUMBERS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.SYSTEM_ALERT_WINDOW&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.WRITE_CONTACTS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.REORDER_TASKS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.CHANGE_WIFI_STATE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.REQUEST_INSTALL_PACKAGES&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_PHONE_NUMBERS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.DISABLE_KEYGUARD&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.SEND_SMS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.MODIFY_AUDIO_SETTINGS&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.VIBRATE&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span></code></pre></div><p>The malware asks for the above permissions.</p>
<h4 id="declaration-of-the-application">Declaration of the Application<a href="#declaration-of-the-application" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;application</span> android:label=<span style="color:#2aa198">&#34;@string/app_name&#34;</span> 
</span></span><span style="display:flex;"><span>	android:icon=<span style="color:#2aa198">&#34;@mipmap/ic_launcher&#34;</span>
</span></span><span style="display:flex;"><span>	android:name=<span style="color:#2aa198">&#34;com.bean.cousin.RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh&#34;</span> 
</span></span><span style="display:flex;"><span>	android:allowBackup=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>	android:hardwareAccelerated=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>	android:largeHeap=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>	android:supportsRtl=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>	android:extractNativeLibs=<span style="color:#2aa198">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>	android:usesCleartextTraffic=<span style="color:#2aa198">&#34;true&#34;</span> 
</span></span><span style="display:flex;"><span>	android:roundIcon=<span style="color:#2aa198">&#34;@mipmap/ic_launcher_round&#34;</span> 
</span></span><span style="display:flex;"><span>	android:appComponentFactory=<span style="color:#2aa198">&#34;androidx.core.app.CoreComponentFactory&#34;</span><span style="color:#268bd2">&gt;</span>
</span></span></code></pre></div><p><img src="./media/application-tag.png" alt="application-tag"></p>
<p><code>android:label=&quot;@string/app_name&quot; android:icon=&quot;@mipmap/ic_launcher&quot;</code>:
In <code>res/values/strings.xml</code> the value of <code>app_name</code> is Chrome and uses the Chrome&rsquo;s icon found in <code>res/mipmap-*/ic_launcher.png</code>.</p>
<p><code>android:name=&quot;com.bean.cousin.RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh&quot;</code>:
The fully qualified name of the application is <code>com.bean.cousin.RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh</code>. When the application process is started, this class is instantiated before any of the application&rsquo;s components.</p>
<p><code>android:allowBackup=&quot;true&quot;</code>:
The application also allows its files to be included in the backup and restore operation.</p>
<p><code>android:hardwareAccelerated=&quot;true&quot;</code>:
Hardware-accelerated rendering should be enabled for all activities in the application.</p>
<p><code>android:largeHeap=&quot;true&quot;</code>:
The application process should be created with a large Dalvik heap.</p>
<p><code>android:supportsRtl=&quot;true&quot;</code>:
Right-to-Left (RTL) is supported.</p>
<p><code>android:extractNativeLibs=&quot;false&quot;</code>:
Native libraries are stored uncompressed in the APK.</p>
<p><code>android:usesCleartextTraffic=&quot;true&quot;</code>:
The malware intends to use plain HTTP requests.</p>
<p><code>android:appComponentFactory=&quot;androidx.core.app.CoreComponentFactory&quot;&gt;</code>:
AndroidX library is used.</p>
<blockquote>
<p>Therefore, upon launch, the <code>com.bean.cousin.RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh</code> will be instantiated first.</p>
</blockquote>
<h2 id="static-analysis---dive-deeper">Static Analysis - Dive Deeper<a href="#static-analysis---dive-deeper" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>The <strong>first class instantiated</strong> as defined in the <code>AndroidManifest.xml</code> file is <code>com.bean.cousin.RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh</code>.</p>
<p>This class extends <code>Application</code> class and overrides <code>onCreate()</code> and <code>attachBaseContext()</code> callbacks.</p>
<p><img src="./media/application-class.png" alt="application-class"></p>
<h4 id="content-provider">Content Provider<a href="#content-provider" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;provider</span> android:name=<span style="color:#2aa198">&#34;androidx.core.content.FileProvider&#34;</span> 
</span></span><span style="display:flex;"><span> android:exported=<span style="color:#2aa198">&#34;false&#34;</span> 
</span></span><span style="display:flex;"><span> android:authorities=<span style="color:#2aa198">&#34;com.devapprove.a.ru.news.provider&#34;</span> 
</span></span><span style="display:flex;"><span> android:grantUriPermissions=<span style="color:#2aa198">&#34;true&#34;</span><span style="color:#268bd2">&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;meta-data</span> android:name=<span style="color:#2aa198">&#34;android.support.FILE_PROVIDER_PATHS&#34;</span> 
</span></span><span style="display:flex;"><span>		android:resource=<span style="color:#2aa198">&#34;@xml/file_provider_paths&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/provider&gt;</span>
</span></span></code></pre></div><p>Malware registers a content-provider for file sharing using <code>content://</code> scheme.</p>
<h4 id="received-sms">Received SMS<a href="#received-sms" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<ul>
<li><code>android.permission.RECEIVE_SMS</code></li>
<li><code>android.intent.action.DATA_SMS_RECEIVED</code></li>
</ul>
<p>Android generates a <code>SMS_RECEIVED</code> broadcast when a new SMS is received.  The malware abuses the priority attribute (assigns the maximum value) in order to receive the SMS broadcast first.</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;receiver</span> android:name=<span style="color:#2aa198">&#34;com.devapprove.a.ru.news.SmsReceiver&#34;</span> 
</span></span><span style="display:flex;"><span> android:permission=<span style="color:#2aa198">&#34;android.permission.BROADCAST_SMS&#34;</span>
</span></span><span style="display:flex;"><span> android:enabled=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span> android:exported=<span style="color:#2aa198">&#34;true&#34;</span><span style="color:#268bd2">&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;intent-filter</span> android:priority=<span style="color:#2aa198">&#34;9999&#34;</span><span style="color:#268bd2">&gt;</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;action</span> android:name=<span style="color:#2aa198">&#34;android.provider.Telephony.SMS_DELIVER&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;/intent-filter&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/receiver&gt;</span>
</span></span></code></pre></div><p><img src="./media/sms-broadcast-receiver.png" alt="sms-broadcast-receiver"></p>
<h4 id="main-activity">Main Activity<a href="#main-activity" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>The main activity of the application: <code>com.devapprove.a.ru.news.ui.LauncherActivity</code> which is not found the <code>classes.dex</code>. So this an indication that the malware is packed and other classes will be loaded into application at run-time.</p>
<blockquote>
<p>Packers typically encrypt the original <code>classes.dex</code> file and embed code (stub) which decrypts the DEX file at runtime and executes it using <code>DexClassLoader</code> class.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;activity</span> android:theme=<span style="color:#2aa198">&#34;@android:style/Theme.Translucent.NoTitleBar.Fullscreen&#34;</span> 
</span></span><span style="display:flex;"><span>  android:name=<span style="color:#2aa198">&#34;com.devapprove.a.ru.news.ui.LauncherActivity&#34;</span> 
</span></span><span style="display:flex;"><span>  android:exported=<span style="color:#2aa198">&#34;true&#34;</span><span style="color:#268bd2">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;intent-filter&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;category</span> android:name=<span style="color:#2aa198">&#34;android.intent.category.LAUNCHER&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;action</span> android:name=<span style="color:#2aa198">&#34;android.intent.action.MAIN&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;/intent-filter&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/activity&gt;</span>
</span></span></code></pre></div><p><img src="./media/main-activity.png" alt="main-activity"></p>
<p>Looking for a <code>DexLoader</code> class we find the following method:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> DexClassLoader <span style="color:#268bd2">uncovercherry</span><span style="color:#719e07">(...)</span> <span style="color:#268bd2">throws</span> Exception <span style="color:#719e07">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	Constructor constructor <span style="color:#719e07">=</span> DexClassLoader<span style="color:#719e07">.</span>class<span style="color:#719e07">.</span>getConstructor<span style="color:#719e07">(</span>String<span style="color:#719e07">.</span>class<span style="color:#719e07">,</span> String<span style="color:#719e07">.</span>class<span style="color:#719e07">,</span> String<span style="color:#719e07">.</span>class<span style="color:#719e07">,</span> ClassLoader<span style="color:#719e07">.</span>class<span style="color:#719e07">);</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span> 
</span></span><span style="display:flex;"><span>	DexClassLoader dexClassLoader <span style="color:#719e07">=</span> <span style="color:#719e07">(</span>DexClassLoader<span style="color:#719e07">)</span> constructor<span style="color:#719e07">.</span>newInstance<span style="color:#719e07">(</span>str<span style="color:#719e07">,</span> str2<span style="color:#719e07">,</span> str3<span style="color:#719e07">,</span> <span style="color:#719e07">(</span>ClassLoader<span style="color:#719e07">)</span> pathhub<span style="color:#719e07">(</span>field<span style="color:#719e07">,</span> weakReference<span style="color:#719e07">));</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">return</span> dexClassLoader<span style="color:#719e07">;</span>  
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p><img src="./media/dexclass-loader.png" alt="dexclass-loader"></p>
<p><code>uncovercherry</code> method uses reflection ( <code>DexClassLoader.class.getConstructor</code> ) to instantiate a <code>DexClassLoader</code> instance.</p>
<p><strong>Call graph</strong></p>
<p>Using <code>androguard</code> and <code>Gephi</code> we can visualize the path that leads to <code>uncovercherry</code> method - which loads the external DEX file.</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ androguard cg 7c805f51ee3b2994e742d73954e51d7c2c24c76455b0b9a1b44d61cb4e280502.apk -o callgraph.gml
</span></span></code></pre></div><p><img src="./media/callgraph.png" alt="callgraph"></p>
<blockquote>
<p>Note: Alternatively, pressing <code>x</code> in Jadx-GUI to find cross-references we can move backwards from <code>uncovercherry()</code> to <code>attachBaseContext()</code>.</p>
</blockquote>
<p>Now that we have a path <code>attachBaseContext() =&gt; decreasesparse() =&gt; damageinform() =&gt; vibrantcricket() =&gt; uncovercherry()</code> let&rsquo;s see how is the <code>dexPath</code> parameter constructed.</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">@Override</span> <span style="color:#586e75">// android.content.ContextWrapper  
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span><span style="color:#268bd2">protected</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">attachBaseContext</span><span style="color:#719e07">(</span>Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	String dexPath <span style="color:#719e07">=</span> nobleamong<span style="color:#719e07">(</span>clusterhole<span style="color:#719e07">);</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#dc322f">boolean</span> royaljungle <span style="color:#719e07">=</span> royaljungle<span style="color:#719e07">(</span>dexPath<span style="color:#719e07">);</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">if</span> <span style="color:#719e07">(</span>royaljungle<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>		decreasespare<span style="color:#719e07">(</span>dexPath<span style="color:#719e07">,</span> clusterhole<span style="color:#719e07">,</span> stringBuffer<span style="color:#719e07">,</span> <span style="color:#719e07">this</span><span style="color:#719e07">.</span>context<span style="color:#719e07">);</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">}</span>  
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p><code>dexPath</code> is initialized as the return value of the <code>nobleamong</code> method, which is defined as:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> String <span style="color:#268bd2">nobleamong</span><span style="color:#719e07">(</span>String str<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">return</span> nuclearinquiry<span style="color:#719e07">(</span>str<span style="color:#719e07">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p><code>nuclearinquiry()</code> method is defined as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> String <span style="color:#268bd2">nuclearinquiry</span><span style="color:#719e07">(</span>String str<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">return</span> inflictair<span style="color:#719e07">(</span>str<span style="color:#719e07">).</span>getAbsolutePath<span style="color:#719e07">();</span>  
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p><code>inflictair()</code> is defined as:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> File <span style="color:#268bd2">inflictair</span><span style="color:#719e07">(</span>String str<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">return</span> <span style="color:#719e07">new</span> File<span style="color:#719e07">(</span>str<span style="color:#719e07">,</span> <span style="color:#719e07">this</span><span style="color:#719e07">.</span>REpOzCiHoGjQpWpQqNnBtIu<span style="color:#719e07">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p>Inside <code>RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh</code>, the attribute <code>REpOzCiHoGjQpWpQqNnBtIu</code> is initialized as the return value of <code>ketcupold()</code> method:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> <span style="color:#268bd2">class</span> <span style="color:#268bd2">RRjCqKwZyTjTiHoWhXqQuHwTzBoOmYxSyNrAbIyYbIqAh</span> <span style="color:#268bd2">extends</span> Application <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span>	String REpOzCiHoGjQpWpQqNnBtIu <span style="color:#719e07">=</span> ketchupold<span style="color:#719e07">(</span><span style="color:#719e07">new</span> <span style="color:#dc322f">int</span><span style="color:#719e07">[</span>5<span style="color:#719e07">]);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">[...]</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">static</span> String <span style="color:#268bd2">ketchupold</span><span style="color:#719e07">(</span><span style="color:#dc322f">int</span><span style="color:#719e07">[]</span> num<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#719e07">return</span> globeonline<span style="color:#719e07">();</span>  
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p>which leads to the decryption algorithm.</p>
<p>Using the following program we can print the original name which is <code>CtaDwII.json</code></p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#719e07">import</span> java.util.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">import</span> java.lang.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">import</span> java.io.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#586e75">// The main method must be in a class named &#34;Main&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span><span style="color:#268bd2">class</span> <span style="color:#268bd2">Main</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> <span style="color:#268bd2">static</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">main</span><span style="color:#719e07">(</span>String<span style="color:#719e07">[]</span> args<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#719e07">.</span>out<span style="color:#719e07">.</span>println<span style="color:#719e07">(</span>globeonline<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> <span style="color:#268bd2">static</span> String <span style="color:#268bd2">globeonline</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">int</span> i <span style="color:#719e07">=</span> 0<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">for</span> <span style="color:#719e07">(</span><span style="color:#dc322f">int</span> i2 <span style="color:#719e07">=</span> 9<span style="color:#719e07">;</span> i2 <span style="color:#719e07">&lt;</span> 41<span style="color:#719e07">;</span> i2<span style="color:#719e07">++)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            i <span style="color:#719e07">=</span> 1038<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">byte</span><span style="color:#719e07">[]</span> bArr <span style="color:#719e07">=</span> <span style="color:#719e07">{</span>80<span style="color:#719e07">,</span> 103<span style="color:#719e07">,</span> 114<span style="color:#719e07">,</span> 87<span style="color:#719e07">,</span> 100<span style="color:#719e07">,</span> 90<span style="color:#719e07">,</span> 90<span style="color:#719e07">,</span> 61<span style="color:#719e07">,</span> 121<span style="color:#719e07">,</span> 96<span style="color:#719e07">,</span> 124<span style="color:#719e07">,</span> 125<span style="color:#719e07">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">int</span> i3 <span style="color:#719e07">=</span> <span style="color:#719e07">-</span>421<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">int</span> i4 <span style="color:#719e07">=</span> <span style="color:#719e07">((-</span>421<span style="color:#719e07">)</span> <span style="color:#719e07">-</span> <span style="color:#719e07">(</span>5066 <span style="color:#719e07">/</span> i<span style="color:#719e07">))</span> <span style="color:#719e07">+</span> 9510<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">byte</span><span style="color:#719e07">[]</span> bArr2 <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> <span style="color:#dc322f">byte</span><span style="color:#719e07">[</span>12<span style="color:#719e07">];</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>i <span style="color:#719e07">==</span> 500<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            i <span style="color:#719e07">=</span> <span style="color:#719e07">(-</span>5499169<span style="color:#719e07">)</span> <span style="color:#719e07">-</span> i4<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">byte</span><span style="color:#719e07">[]</span> bArr3 <span style="color:#719e07">=</span> <span style="color:#719e07">{</span>19<span style="color:#719e07">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">for</span> <span style="color:#719e07">(</span><span style="color:#dc322f">int</span> i5 <span style="color:#719e07">=</span> 9<span style="color:#719e07">;</span> i5 <span style="color:#719e07">&lt;</span> 10<span style="color:#719e07">;</span> i5<span style="color:#719e07">++)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            i4 <span style="color:#719e07">=</span> <span style="color:#719e07">((</span>i <span style="color:#719e07">-</span> 60025<span style="color:#719e07">)</span> <span style="color:#719e07">-</span> <span style="color:#719e07">(-</span>421<span style="color:#719e07">))</span> <span style="color:#719e07">+</span> 32320<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">if</span> <span style="color:#719e07">(-</span>421 <span style="color:#719e07">==</span> i4<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            i3 <span style="color:#719e07">=</span> <span style="color:#719e07">((</span>i4 <span style="color:#719e07">+</span> 9<span style="color:#719e07">)</span> <span style="color:#719e07">+</span> 6<span style="color:#719e07">)</span> <span style="color:#719e07">-</span> i<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>i <span style="color:#719e07">&lt;=</span> i4<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            i <span style="color:#719e07">=</span> <span style="color:#719e07">(</span>79116 <span style="color:#719e07">-</span> <span style="color:#719e07">(</span>i4 <span style="color:#719e07">*</span> i3<span style="color:#719e07">))</span> <span style="color:#719e07">-</span> 91782<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">for</span> <span style="color:#719e07">(</span><span style="color:#dc322f">int</span> i6 <span style="color:#719e07">=</span> 6<span style="color:#719e07">;</span> i6 <span style="color:#719e07">&lt;</span> 8<span style="color:#719e07">;</span> i6<span style="color:#719e07">++)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dc322f">int</span> i7 <span style="color:#719e07">=</span> 0<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">while</span> <span style="color:#719e07">(</span>i7 <span style="color:#719e07">&lt;</span> 12<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#dc322f">int</span> i8 <span style="color:#719e07">=</span> i <span style="color:#719e07">+</span> 42811<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#dc322f">int</span> i9 <span style="color:#719e07">=</span> 31 <span style="color:#719e07">-</span> i8<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#dc322f">int</span> i10 <span style="color:#719e07">=</span> i8 <span style="color:#719e07">-</span> <span style="color:#719e07">(</span>i9 <span style="color:#719e07">*</span> 78<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>            bArr2<span style="color:#719e07">[</span>i7<span style="color:#719e07">]</span> <span style="color:#719e07">=</span> <span style="color:#719e07">(</span><span style="color:#dc322f">byte</span><span style="color:#719e07">)</span> <span style="color:#719e07">(((((((</span>i8 <span style="color:#719e07">-</span> i9<span style="color:#719e07">)</span> <span style="color:#719e07">+</span> i10<span style="color:#719e07">)</span> <span style="color:#719e07">*</span> 0<span style="color:#719e07">)</span> <span style="color:#719e07">+</span> bArr<span style="color:#719e07">[</span>i7<span style="color:#719e07">])</span> <span style="color:#719e07">+</span> <span style="color:#719e07">(((</span>i10 <span style="color:#719e07">/</span> i10<span style="color:#719e07">)</span> <span style="color:#719e07">/</span> 1<span style="color:#719e07">)</span> <span style="color:#719e07">^</span> 1<span style="color:#719e07">))</span> <span style="color:#719e07">+</span> <span style="color:#719e07">(</span>i10 <span style="color:#719e07">%</span> i10<span style="color:#719e07">))</span> <span style="color:#719e07">^</span> bArr3<span style="color:#719e07">[</span>i7 <span style="color:#719e07">%</span> 1<span style="color:#719e07">]);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#dc322f">int</span> i11 <span style="color:#719e07">=</span> i10 <span style="color:#719e07">/</span> 8096345<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>            i7<span style="color:#719e07">++;</span>
</span></span><span style="display:flex;"><span>            i <span style="color:#719e07">=</span> i10<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">for</span> <span style="color:#719e07">(</span><span style="color:#dc322f">int</span> i12 <span style="color:#719e07">=</span> 19<span style="color:#719e07">;</span> i12 <span style="color:#719e07">&lt;</span> 47<span style="color:#719e07">;</span> i12<span style="color:#719e07">++)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">return</span> <span style="color:#719e07">new</span> String<span style="color:#719e07">(</span>bArr2<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p><img src="./media/decrypted-dexpath.png" alt="decrypted-dexpath"></p>
<p><img src="Pasted%20image%2020221103103139.png" alt=""></p>
<h4 id="accessibility-service">Accessibility Service<a href="#accessibility-service" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>More info: <a href="https://developer.android.com/reference/android/accessibilityservice/AccessibilityServiceInfo">https://developer.android.com/reference/android/accessibilityservice/AccessibilityServiceInfo</a></p>
<ul>
<li><code>android.permission.BIND_ACCESSIBILITY_SERVICE</code></li>
<li><code>android.accessibilityservice.AccessibilityService</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;service</span> android:label=<span style="color:#2aa198">&#34;@string/app_name&#34;</span> 
</span></span><span style="display:flex;"><span>	android:name=<span style="color:#2aa198">&#34;com.devapprove.a.ru.news.service.AppAccessibilityService&#34;</span> 
</span></span><span style="display:flex;"><span>	android:permission=<span style="color:#2aa198">&#34;android.permission.BIND_ACCESSIBILITY_SERVICE&#34;</span> 
</span></span><span style="display:flex;"><span>	android:exported=<span style="color:#2aa198">&#34;false&#34;</span><span style="color:#268bd2">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;intent-filter&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;action</span> 			android:name=<span style="color:#2aa198">&#34;android.accessibilityservice.AccessibilityService&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;/intent-filter&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;meta-data</span> android:name=<span style="color:#2aa198">&#34;android.accessibilityservice&#34;</span> 
</span></span><span style="display:flex;"><span>		android:resource=<span style="color:#2aa198">&#34;@xml/accessibilityservice&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/service&gt;</span>
</span></span></code></pre></div><p><img src="./media/accessibility-service.png" alt="accessibility-service"></p>
<p>The related <code>res/xml/accessibilityservice.xml</code> file contains:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#719e07">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;accessibility-service</span> xmlns:android=<span style="color:#2aa198">&#34;http://schemas.android.com/apk/res/android&#34;</span>
</span></span><span style="display:flex;"><span>	android:description=<span style="color:#2aa198">&#34;@string/accessibility_service_description&#34;</span> 
</span></span><span style="display:flex;"><span>	android:accessibilityEventTypes=<span style="color:#2aa198">&#34;typeAllMask&#34;</span>
</span></span><span style="display:flex;"><span>	android:accessibilityFlags=<span style="color:#2aa198">&#34;flagReportViewIds|flagRequestTouchExplorationMode|flagIncludeNotImportantViews|flagDefault&#34;</span>
</span></span><span style="display:flex;"><span>	android:canRetrieveWindowContent=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>	android:canPerformGestures=<span style="color:#2aa198">&#34;true&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span></code></pre></div><p><code>android:accessibilityEventTypes=&quot;typeAllMask&quot;</code>:
Receives all events ( <code>AccessibilityEvent.TYPES_ALL_MASK</code> )</p>
<p><code>android:canRetrieveWindowContent=&quot;true&quot;</code>:
The accessibility service is able to retrieve the active window content.</p>
<h4 id="notification-service">Notification Service<a href="#notification-service" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>The application registers a service that receives calls from the system when new notifications are posted or removed, or their ranking changed.</p>
<ul>
<li><code>android.permission.BIND_NOTIFICATION_LISTENER_SERVICE</code></li>
<li><code>android.service.notification.NotificationListenerService</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;service</span> android:name=<span style="color:#2aa198">&#34;com.devapprove.a.ru.news.service.NotificationService&#34;</span> 
</span></span><span style="display:flex;"><span>	android:permission=<span style="color:#2aa198">&#34;android.permission.BIND_NOTIFICATION_LISTENER_SERVICE&#34;</span> 
</span></span><span style="display:flex;"><span>	android:enabled=<span style="color:#2aa198">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>	android:exported=<span style="color:#2aa198">&#34;false&#34;</span><span style="color:#268bd2">&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;intent-filter&gt;</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;action</span> android:name=<span style="color:#2aa198">&#34;android.service.notification.NotificationListenerService&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;/intent-filter&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/service&gt;</span>
</span></span></code></pre></div><p><img src="./media/notification-service.png" alt="notification-service"></p>
<h4 id="device-admin">Device Admin<a href="#device-admin" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>More info: <a href="https://developer.android.com/guide/topics/admin/device-admin">https://developer.android.com/guide/topics/admin/device-admin</a></p>
<ul>
<li>extends <code>DeviceAdminReceiver</code> class</li>
<li><code>android.permission.BIND_DEVICE_ADMIN</code> permission</li>
<li><code>android.app.action.DEVICE_ADMIN_ENABLED</code> action the application must handle</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;receiver</span> android:name=<span style="color:#2aa198">&#34;com.devapprove.a.ru.news.MyAdminReceiver&#34;</span> 
</span></span><span style="display:flex;"><span>		  android:permission=<span style="color:#2aa198">&#34;android.permission.BIND_DEVICE_ADMIN&#34;</span> 
</span></span><span style="display:flex;"><span>		  android:exported=<span style="color:#2aa198">&#34;true&#34;</span><span style="color:#268bd2">&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;meta-data</span> android:name=<span style="color:#2aa198">&#34;android.app.device_admin&#34;</span> 
</span></span><span style="display:flex;"><span>		android:resource=<span style="color:#2aa198">&#34;@xml/admin&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;intent-filter&gt;</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;action</span> android:name=<span style="color:#2aa198">&#34;android.app.action.DEVICE_ADMIN_ENABLED&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">&lt;action</span> android:name=<span style="color:#2aa198">&#34;android.app.action.DEVICE_ADMIN_DISABLED&#34;</span><span style="color:#268bd2">/&gt;</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">&lt;/intent-filter&gt;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/receiver&gt;</span>
</span></span></code></pre></div><p><img src="./media/device-admin.png" alt="device-admin"></p>
<p>The related <code>res/xml/admin.xml</code> file contains the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#719e07">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;device-admin&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">&lt;uses-policies&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">&lt;force-lock/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">&lt;set-global-proxy/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">&lt;encrypted-storage/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">&lt;/uses-policies&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/device-admin&gt;</span>
</span></span></code></pre></div>
      </div></div>

  
    
  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span> 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>







<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
